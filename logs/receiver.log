2025-03-18 23:46:44,294 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-18 23:46:44,351 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-18 23:46:44,388 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:46:44,389 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:46:44,389 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-18 23:46:44,390 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:46:44,391 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:46:44,393 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:46:44,394 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:46:44,394 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:46:44,395 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:46:44,396 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:46:44,396 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:46:44,397 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:46:44,397 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:46:44,398 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-18 23:46:44,398 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:46:44,399 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:46:44,399 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:46:44,400 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:46:44,400 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:46:44,401 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:46:44,401 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-18 23:46:44,402 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:46:44,402 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:46:44,403 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-18 23:46:44,404 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-18 23:46:44,404 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:46:44,405 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:46:44,405 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-18 23:46:44,406 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:46:44,406 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:46:44,407 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-18 23:46:44,408 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-18 23:46:44,408 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-18 23:49:36,168 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-18 23:49:36,253 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-18 23:49:36,306 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:49:36,307 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:49:36,308 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-18 23:49:36,309 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:49:36,309 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:49:36,312 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:49:36,313 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:49:36,314 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:49:36,315 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:49:36,315 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:49:36,316 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:49:36,317 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:49:36,317 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:49:36,318 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-18 23:49:36,318 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:49:36,319 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:49:36,320 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:49:36,321 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:49:36,321 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:49:36,322 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:49:36,323 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-18 23:49:36,323 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:49:36,324 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:49:36,324 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-18 23:49:36,325 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-18 23:49:36,325 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:49:36,326 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:49:36,327 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-18 23:49:36,328 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:49:36,328 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:49:36,329 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-18 23:49:36,330 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-18 23:49:36,331 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-18 23:57:35,651 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-18 23:57:35,876 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-18 23:57:36,050 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:57:36,061 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:57:36,067 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-18 23:57:36,068 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:57:36,069 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:57:36,080 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:57:36,081 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:57:36,084 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:57:36,087 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:57:36,089 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:57:36,096 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:57:36,097 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:57:36,097 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:57:36,098 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-18 23:57:36,099 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:57:36,099 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:57:36,103 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:57:36,105 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:57:36,109 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:57:36,111 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:57:36,111 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-18 23:57:36,113 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:57:36,113 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:57:36,114 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-18 23:57:36,115 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-18 23:57:36,117 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:57:36,117 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:57:36,118 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-18 23:57:36,118 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-18 23:57:36,119 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-18 23:57:36,119 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-18 23:57:36,120 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-18 23:57:36,121 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-19 00:05:01,244 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-19 00:05:01,307 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 00:05:01,368 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:05:01,372 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:05:01,378 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 00:05:01,383 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:05:01,384 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:05:01,390 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:05:01,392 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:05:01,399 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:05:01,400 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:05:01,401 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:05:01,402 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:05:01,403 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:05:01,403 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:05:01,404 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-19 00:05:01,405 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:05:01,405 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:05:01,406 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:05:01,407 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:05:01,408 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:05:01,408 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:05:01,409 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 00:05:01,410 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:05:01,410 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:05:01,411 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 00:05:01,412 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 00:05:01,412 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:05:01,413 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:05:01,414 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 00:05:01,414 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:05:01,415 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:05:01,416 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-19 00:05:01,417 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-19 00:05:01,418 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-19 00:06:19,476 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:06:19,482 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:06:19,482 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:06:19,484 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:06:19,486 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:06:19,486 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:19,486 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:19,787 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:06:19,788 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:19,788 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:19,831 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:06:19,834 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:06:19,834 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:06:19,835 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:06:19,835 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:06:19,836 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:19,836 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:20,089 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:06:20,089 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:20,089 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:20,137 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:06:20,138 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:20,138 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:20,390 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:06:20,391 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:06:20,391 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:06:20,392 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:06:20,392 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:20,392 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:20,440 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:06:20,441 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:20,443 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:20,693 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:06:20,694 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:20,695 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:20,744 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:06:20,744 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:06:20,745 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:06:20,746 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:06:20,746 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:20,746 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:20,997 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:06:20,998 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:20,999 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:21,047 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:06:21,048 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:21,048 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:21,300 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:06:21,302 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:06:21,305 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:06:21,307 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:06:21,308 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:21,309 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:21,349 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:06:21,349 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:21,350 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:21,610 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:06:21,611 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:21,611 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:21,650 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:06:21,651 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:06:21,651 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:06:21,652 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:06:21,652 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:21,652 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:21,912 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:06:21,912 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:21,913 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:21,953 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:06:21,953 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:21,954 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:22,213 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:06:22,213 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:06:22,219 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 25, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:06:22,249 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 00:06:22,255 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:06:22,255 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:06:22,255 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:06:22,256 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:22,256 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:06:22,256 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:22,257 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:06:22,257 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:22,257 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:22,557 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:06:22,558 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:06:22,558 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:06:22,559 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:22,559 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 25, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:06:22,560 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:22,566 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 00:06:22,567 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:06:22,568 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:06:22,568 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:06:22,569 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:06:22,569 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:22,569 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:22,864 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:06:22,865 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:22,865 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:22,870 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:06:22,870 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:22,871 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:23,165 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:06:23,166 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:06:23,167 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:06:23,167 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:06:23,167 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:23,168 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:23,171 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:06:23,172 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:23,172 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:23,469 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:06:23,469 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:23,469 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:23,472 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:06:23,473 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:06:23,473 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:06:23,474 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:06:23,474 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:23,474 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:23,770 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:06:23,771 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:23,771 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:23,775 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:06:23,776 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:23,776 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:24,071 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:06:24,072 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:06:24,073 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:06:24,073 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:06:24,074 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:24,074 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:24,077 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:06:24,077 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:24,078 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:24,375 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:06:24,376 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:24,377 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:24,378 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:06:24,379 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:06:24,379 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:06:24,380 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:06:24,380 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:24,380 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:24,678 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:06:24,678 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:24,678 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:24,681 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:06:24,682 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:24,682 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:24,979 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:06:24,980 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:06:24,980 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 45, in post_audience_interaction_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:06:24,985 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:06:24,986 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:06:24,986 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:06:25,287 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:06:25,287 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:06:25,288 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 45, in post_audience_interaction_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:14:13,625 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-19 00:14:13,753 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 00:14:13,852 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:14:13,857 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:14:13,863 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 00:14:13,864 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:14:13,866 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:14:13,879 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:14:13,909 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:14:13,921 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:14:13,922 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:14:13,923 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:14:13,926 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:14:13,928 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:14:13,931 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:14:13,942 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-19 00:14:13,948 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:14:13,949 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:14:13,950 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:14:13,950 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:14:13,951 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:14:13,951 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:14:13,952 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 00:14:13,953 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:14:13,953 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:14:13,954 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 00:14:13,954 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 00:14:13,955 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:14:13,956 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:14:13,956 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 00:14:13,957 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:14:13,957 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:14:13,958 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-19 00:14:13,960 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-19 00:14:13,960 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-19 00:18:05,682 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-19 00:18:05,886 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 00:18:06,000 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:18:06,005 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:18:06,008 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 00:18:06,008 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:18:06,009 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:18:06,012 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:18:06,012 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:18:06,013 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:18:06,013 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:18:06,015 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:18:06,015 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:18:06,016 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:18:06,017 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:18:06,017 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-19 00:18:06,018 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:18:06,020 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:18:06,027 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:18:06,027 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:18:06,028 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:18:06,029 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:18:06,029 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 00:18:06,030 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:18:06,030 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:18:06,041 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 00:18:06,042 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 00:18:06,046 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:18:06,047 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:18:06,048 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 00:18:06,049 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:18:06,053 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:18:06,057 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-19 00:18:06,061 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-19 00:18:06,067 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-19 00:19:46,496 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:19:46,503 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:19:46,504 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:19:46,504 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:46,505 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:46,505 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:46,506 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:46,807 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:46,807 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:46,808 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:47,003 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:19:47,005 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:19:47,006 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:19:47,006 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:47,007 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:47,007 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:47,007 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:47,108 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:47,109 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:47,109 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:47,308 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:47,308 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:47,309 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:47,410 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:47,411 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:47,411 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:47,412 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:47,412 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:47,413 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:47,609 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:47,610 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:47,610 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:47,714 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:47,714 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:47,715 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:47,910 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:47,911 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:47,912 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:47,912 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:47,912 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:47,913 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:48,015 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:48,016 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:48,016 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:48,214 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:48,215 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:48,215 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:48,317 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:48,318 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:48,319 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:48,319 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:48,320 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:48,320 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:48,516 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:48,517 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:48,517 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:48,621 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:48,622 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:48,622 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:48,818 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:48,818 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:48,819 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:48,820 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:48,820 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:48,820 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:48,923 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:48,923 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:48,924 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:49,121 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:49,121 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:49,122 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:49,224 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:49,225 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:49,233 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 25, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:19:49,245 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 00:19:49,254 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:19:49,254 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:19:49,255 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:49,256 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:49,256 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:49,256 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:49,423 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:49,424 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:49,424 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:49,557 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:49,558 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:49,558 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:49,724 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:49,725 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:49,726 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 25, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:19:49,734 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 00:19:49,736 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:19:49,736 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:19:49,737 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:49,738 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:49,738 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:49,738 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:49,859 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:49,860 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:49,870 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:50,039 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:50,040 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:50,041 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:50,171 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:50,171 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:50,172 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:50,173 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:50,173 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:50,173 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:50,342 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:50,343 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:50,343 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:50,474 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:50,475 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:50,475 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:50,644 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:50,645 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:50,646 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:50,647 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:50,647 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:50,648 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:50,776 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:50,776 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:50,777 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:50,949 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:50,949 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:50,950 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:51,078 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:51,079 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:51,079 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:51,080 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:51,080 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:51,080 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:51,251 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:51,252 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:51,252 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:51,381 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:51,382 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:51,382 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:51,553 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:51,553 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:51,554 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:51,554 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:51,555 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:51,555 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:51,683 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:51,684 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:51,684 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:51,856 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:51,856 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:51,857 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:51,985 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:51,986 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:51,987 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 45, in post_audience_interaction_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:19:51,996 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:19:51,999 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:19:51,999 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:19:52,000 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:52,000 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:52,001 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:52,001 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:52,157 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:52,158 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:52,158 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:52,302 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:52,303 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:52,303 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:52,459 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:52,459 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:52,460 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 45, in post_audience_interaction_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:19:52,468 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:19:52,470 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:19:52,470 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:19:52,471 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:52,472 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:52,472 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:52,472 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:52,604 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:52,605 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:52,605 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:52,773 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:52,774 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:52,774 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:52,907 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:52,907 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:52,908 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:52,908 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:52,909 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:52,909 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:53,076 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:53,076 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:53,077 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:53,210 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:53,211 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:53,211 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:53,377 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:53,378 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:53,378 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:53,379 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:53,379 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:53,380 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:53,512 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:53,512 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:53,513 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:53,681 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:53,681 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:53,681 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:53,814 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:53,815 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:53,815 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:53,816 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:53,816 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:53,816 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:53,982 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:53,983 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:53,984 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:54,117 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:54,117 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:54,118 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:54,284 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:54,285 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:54,285 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:54,286 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:54,286 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:54,287 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:54,419 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:54,419 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:54,420 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:54,587 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:54,588 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:54,588 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:54,721 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:54,722 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:54,725 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 25, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:19:54,742 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 00:19:54,743 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:19:54,744 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:19:54,744 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:54,745 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:54,745 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:54,745 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:54,889 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:54,889 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:54,890 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:55,046 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:55,046 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:55,047 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:55,190 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:55,191 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:55,192 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 25, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:19:55,198 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 00:19:55,199 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:19:55,200 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:19:55,200 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:55,200 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:55,201 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:55,201 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:55,348 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:55,349 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:55,350 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:55,502 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:55,503 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:55,503 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:55,652 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:55,652 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:55,653 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:55,653 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:55,653 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:55,654 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:55,804 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:55,804 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:55,804 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:55,954 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:55,955 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:55,956 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:56,105 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:56,105 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:56,106 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:56,106 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:56,107 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:56,107 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:56,257 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:56,258 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:56,259 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:56,409 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:56,410 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:56,411 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:56,560 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:56,560 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:56,561 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:56,561 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:56,562 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:56,562 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:56,712 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:56,713 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:56,713 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:56,863 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:56,864 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:56,865 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:57,014 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:57,014 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:57,014 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:19:57,015 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:19:57,015 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:57,015 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:57,167 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:57,167 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:57,168 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:57,316 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:19:57,317 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:57,317 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:57,468 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:57,469 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:57,470 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 45, in post_audience_interaction_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:19:57,618 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:19:57,618 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:19:57,619 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:19:57,919 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:19:57,920 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:19:57,921 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 45, in post_audience_interaction_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:22:36,136 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:22:36,141 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:22:36,142 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:22:36,143 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:36,144 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:36,144 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:36,145 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:36,446 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:36,447 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:36,449 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:36,638 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:22:36,641 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:22:36,641 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:22:36,642 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:36,642 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:36,643 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:36,643 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:36,750 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:36,750 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:36,751 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:36,944 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:36,945 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:36,946 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:37,052 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:37,053 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:37,055 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:37,056 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:37,056 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:37,056 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:37,247 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:37,248 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:37,248 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:37,357 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:37,358 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:37,359 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:37,549 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:37,550 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:37,551 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:37,551 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:37,552 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:37,552 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:37,660 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:37,661 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:37,662 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:37,853 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:37,853 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:37,854 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:37,963 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:37,963 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:37,964 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:37,965 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:37,965 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:37,965 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:38,155 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:38,158 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:38,159 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:38,267 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:38,268 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:38,269 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:38,460 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:38,461 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:38,462 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:38,464 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:38,465 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:38,466 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:38,570 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:38,571 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:38,572 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:38,768 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:38,769 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:38,770 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:38,873 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:38,874 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:38,876 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 25, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:22:38,890 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 00:22:38,892 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:22:38,892 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:22:38,893 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:38,893 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:38,893 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:38,893 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:39,071 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:39,072 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:39,072 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:39,192 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:39,193 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:39,194 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:39,371 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:39,371 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:39,372 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 25, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:22:39,379 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 00:22:39,381 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:22:39,381 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:22:39,381 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:39,382 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:39,382 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:39,382 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:39,497 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:39,497 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:39,497 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:39,683 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:39,684 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:39,684 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:39,798 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:39,798 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:39,799 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:39,799 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:39,800 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:39,800 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:39,985 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:39,985 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:39,986 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:40,101 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:40,101 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:40,101 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:40,286 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:40,287 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:40,287 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:40,288 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:40,288 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:40,288 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:40,402 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:40,403 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:40,403 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:40,589 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:40,590 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:40,590 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:40,704 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:40,705 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:40,705 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:40,706 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:40,706 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:40,706 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:40,891 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:40,893 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:40,894 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:41,007 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:41,008 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:41,008 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:41,195 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:41,195 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:41,196 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:41,197 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:41,197 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:41,197 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:41,309 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:41,309 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:41,310 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:41,498 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:41,499 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:41,499 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:41,610 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:41,611 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:41,612 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 45, in post_audience_interaction_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:22:41,619 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:22:41,621 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:22:41,629 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:22:41,630 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:41,630 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:41,631 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:41,631 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:41,800 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:41,801 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:41,801 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:41,932 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:41,932 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:41,932 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:42,101 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:42,102 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:42,103 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 45, in post_audience_interaction_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:22:42,109 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:22:42,111 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:22:42,111 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:22:42,112 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:42,112 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:42,113 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:42,113 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:42,233 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:42,234 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:42,235 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:42,414 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:42,414 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:42,415 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:42,535 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:42,535 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:42,536 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:42,536 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:42,537 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:42,537 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:42,716 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:42,716 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:42,716 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:42,838 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:42,838 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:42,839 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:43,017 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:43,017 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:43,018 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:43,019 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:43,019 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:43,019 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:43,139 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:43,140 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:43,140 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:43,320 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:43,320 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:43,321 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:43,441 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:43,442 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:43,442 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:43,443 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:43,443 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:43,443 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:43,622 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:43,622 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:43,623 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:43,745 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:43,746 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:43,747 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:43,923 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:43,924 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:43,926 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:43,927 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:43,927 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:43,929 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:44,048 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:44,050 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:44,051 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:44,230 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:44,231 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:44,232 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:44,353 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:44,353 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:44,354 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 25, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:22:44,364 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 00:22:44,366 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:22:44,366 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:22:44,366 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:44,367 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:44,367 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:44,367 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:44,533 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:44,534 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:44,534 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:44,668 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:44,669 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:44,669 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:44,835 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:44,836 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:44,837 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 25, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:22:44,970 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:44,972 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:44,972 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:45,274 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:45,275 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:45,275 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:45,277 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:45,277 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:45,278 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:45,580 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:45,581 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:45,582 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:45,883 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:45,884 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:45,884 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:46,185 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:46,186 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:46,187 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:22:46,188 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:22:46,189 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:46,190 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:46,491 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:22:46,491 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:46,492 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:46,793 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:22:46,793 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:22:46,794 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:22:47,094 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:22:47,095 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:22:47,095 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 45, in post_audience_interaction_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:24:56,212 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-19 00:24:56,287 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 00:24:56,393 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:24:56,394 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:24:56,395 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 00:24:56,396 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:24:56,396 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:24:56,399 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:24:56,400 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:24:56,401 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:24:56,401 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:24:56,402 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:24:56,402 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:24:56,413 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:24:56,413 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:24:56,414 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-19 00:24:56,414 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:24:56,415 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:24:56,416 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:24:56,416 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:24:56,417 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:24:56,417 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:24:56,418 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 00:24:56,426 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:24:56,431 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:24:56,445 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 00:24:56,446 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 00:24:56,447 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:24:56,448 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:24:56,448 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 00:24:56,449 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 00:24:56,449 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 00:24:56,450 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-19 00:24:56,451 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-19 00:24:56,451 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-19 00:25:45,582 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:25:45,591 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:25:45,591 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:25:45,592 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:45,593 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:45,593 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:45,593 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:45,894 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:45,894 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:45,895 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:46,089 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:25:46,092 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:25:46,092 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:25:46,093 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:46,094 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:46,094 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:46,095 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:46,195 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:46,196 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:46,196 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:46,395 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:46,396 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:46,396 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:46,496 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:46,497 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:46,498 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:46,498 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:46,498 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:46,499 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:46,697 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:46,697 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:46,698 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:46,799 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:46,800 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:46,800 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:46,998 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:46,999 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:46,999 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:47,000 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:47,000 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:47,000 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:47,101 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:47,101 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:47,102 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:47,301 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:47,302 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:47,302 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:47,402 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:47,403 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:47,403 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:47,404 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:47,404 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:47,404 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:47,603 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:47,603 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:47,603 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:47,705 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:47,705 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:47,706 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:47,904 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:47,905 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:47,905 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:47,906 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:47,907 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:47,907 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:48,006 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:48,007 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:48,007 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:48,208 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:48,208 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:48,208 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:48,308 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:48,308 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:48,315 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 26, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:25:48,325 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 00:25:48,333 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:25:48,334 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:25:48,334 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:48,335 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:48,335 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:48,335 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:48,509 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:48,510 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:48,510 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:48,636 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:48,637 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:48,637 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:48,810 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:48,811 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:48,812 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 26, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:25:48,819 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 00:25:48,820 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:25:48,821 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:25:48,821 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:48,822 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:48,822 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:48,822 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:48,937 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:48,938 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:48,938 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:49,124 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:49,125 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:49,127 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:49,239 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:49,239 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:49,240 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:49,240 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:49,241 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:49,241 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:49,429 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:49,430 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:49,431 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:49,542 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:49,543 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:49,543 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:49,733 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:49,736 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:49,739 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:49,741 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:49,742 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:49,743 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:49,844 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:49,844 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:49,844 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:50,045 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:50,045 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:50,046 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:50,145 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:50,146 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:50,147 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:50,148 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:50,148 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:50,149 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:50,347 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:50,347 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:50,347 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:50,450 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:50,451 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:50,452 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:50,648 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:50,648 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:50,649 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:50,649 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:50,650 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:50,650 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:50,753 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:50,753 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:50,754 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:50,951 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:50,952 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:50,953 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:51,054 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:51,056 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:51,059 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 45, in post_audience_interaction_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:25:51,072 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:25:51,074 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:25:51,074 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:25:51,074 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:51,075 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:51,075 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:51,075 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:51,255 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:51,255 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:51,255 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:51,377 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:51,378 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:51,379 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:51,556 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:51,556 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:51,557 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 45, in post_audience_interaction_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:25:51,563 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:25:51,565 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:25:51,565 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:25:51,565 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:51,566 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:51,566 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:51,567 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:51,681 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:51,682 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:51,683 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:51,868 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:51,869 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:51,870 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:51,984 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:51,986 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:51,988 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:51,989 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:51,990 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:51,991 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:52,171 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:52,172 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:52,172 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:52,293 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:52,294 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:52,295 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:52,473 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:52,474 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:52,475 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:52,477 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:52,478 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:52,479 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:52,596 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:52,597 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:52,597 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:52,779 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:52,780 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:52,780 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:52,898 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:52,899 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:52,900 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:52,900 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:52,901 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:52,901 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:53,081 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:53,081 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:53,082 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:53,202 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:53,203 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:53,203 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:53,382 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:53,383 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:53,383 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:53,384 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:53,384 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:53,384 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:53,504 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:53,505 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:53,505 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:53,685 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:53,685 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:53,686 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:53,805 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:53,806 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:53,807 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 26, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:25:53,813 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 00:25:53,824 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:25:53,825 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:25:53,825 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:53,826 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:53,826 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:53,826 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:53,986 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:53,987 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:53,987 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:54,127 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:54,127 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:54,127 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:54,288 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:54,288 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:54,289 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 26, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:25:54,298 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 00:25:54,300 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:25:54,301 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:25:54,301 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:54,302 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:54,302 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:54,303 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:54,428 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:54,428 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:54,429 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:54,603 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:54,604 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:54,604 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:54,729 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:54,730 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:54,730 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:54,731 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:54,731 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:54,732 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:54,905 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:54,905 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:54,906 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:55,032 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:55,033 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:55,033 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:55,206 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:55,207 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:55,207 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:55,208 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:55,209 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:55,209 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:55,334 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:55,334 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:55,334 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:55,510 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:55,510 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:55,511 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:55,635 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:55,635 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:55,636 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:55,636 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:55,636 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:55,637 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:55,812 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:55,812 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:55,812 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:55,937 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:55,938 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:55,938 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:56,113 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:56,113 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:56,114 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:25:56,114 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:25:56,115 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:56,115 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:56,239 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:56,239 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:56,240 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:56,416 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:25:56,416 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:56,416 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:56,540 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:56,541 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:56,542 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 45, in post_audience_interaction_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:25:56,717 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:25:56,718 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:25:56,718 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:25:57,018 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:25:57,019 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:25:57,020 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 45, in post_audience_interaction_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:26:44,783 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:26:44,786 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:26:44,786 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:26:44,786 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:44,787 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:44,787 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:44,787 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:45,088 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:45,089 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:45,089 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:45,287 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:26:45,291 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:26:45,292 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:26:45,293 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:45,294 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:45,294 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:45,295 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:45,390 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:45,390 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:45,391 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:45,596 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:45,596 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:45,596 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:45,691 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:45,692 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:45,692 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:45,693 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:45,693 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:45,693 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:45,897 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:45,898 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:45,898 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:45,994 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:45,996 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:45,997 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:46,199 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:46,200 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:46,202 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:46,203 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:46,204 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:46,205 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:46,299 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:46,300 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:46,301 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:46,506 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:46,507 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:46,507 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:46,602 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:46,603 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:46,603 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:46,604 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:46,604 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:46,604 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:46,808 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:46,809 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:46,809 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:46,905 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:46,906 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:46,906 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:47,109 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:47,110 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:47,110 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:47,111 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:47,111 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:47,111 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:47,207 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:47,207 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:47,208 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:47,412 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:47,412 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:47,413 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:47,508 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:47,509 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:47,510 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 26, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:26:47,518 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 00:26:47,520 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:26:47,520 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:26:47,520 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:47,521 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:47,521 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:47,521 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:47,713 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:47,714 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:47,714 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:47,822 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:47,823 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:47,823 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:48,015 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:48,015 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:48,016 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 26, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:26:48,022 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 00:26:48,024 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:26:48,024 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:26:48,024 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:48,025 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:48,025 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:48,025 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:48,124 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:48,125 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:48,125 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:48,326 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:48,327 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:48,327 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:48,425 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:48,426 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:48,426 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:48,427 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:48,427 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:48,427 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:48,628 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:48,629 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:48,629 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:48,728 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:48,728 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:48,729 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:48,930 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:48,930 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:48,930 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:48,931 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:48,931 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:48,931 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:49,029 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:49,030 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:49,030 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:49,232 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:49,233 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:49,233 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:49,331 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:49,332 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:49,332 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:49,333 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:49,334 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:49,335 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:49,534 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:49,534 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:49,535 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:49,636 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:49,636 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:49,637 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:49,835 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:49,835 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:49,836 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:49,836 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:49,837 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:49,837 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:49,938 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:49,938 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:49,938 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:50,138 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:50,138 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:50,139 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:50,239 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:50,239 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:50,240 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 45, in post_audience_interaction_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:26:50,246 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:26:50,249 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:26:50,250 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:26:50,250 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:50,251 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:50,251 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:50,251 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:50,439 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:50,440 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:50,440 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:50,552 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:50,553 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:50,554 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:50,741 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:50,743 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:50,744 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 45, in post_audience_interaction_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:26:50,753 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 00:26:50,756 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 00:26:50,756 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 00:26:50,757 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:50,757 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:50,758 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:50,759 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:50,855 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:50,855 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:50,856 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:51,060 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:51,062 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:51,073 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:51,156 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:51,156 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:51,157 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:51,157 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:51,158 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:51,158 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:51,375 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:51,376 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:51,377 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:51,459 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:51,460 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:51,460 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:51,677 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:51,678 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:51,679 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:51,679 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:51,679 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:51,680 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:51,761 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:51,762 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:51,762 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:51,980 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:51,981 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:51,981 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:52,063 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:52,064 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:52,065 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:52,067 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:52,068 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:52,068 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:52,282 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:52,282 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:52,283 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:52,369 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:52,370 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:52,370 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:52,583 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:52,584 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:52,584 - pykafka.connection - DEBUG - Connecting to localhost:9092
2025-03-19 00:26:52,585 - pykafka.connection - INFO - Attempt 0: failed to connect to localhost:9092
2025-03-19 00:26:52,585 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:52,585 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:52,671 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:52,671 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:52,672 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:52,886 - pykafka.connection - INFO - Attempt 1: failed to connect to localhost:9092
2025-03-19 00:26:52,887 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:52,888 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:52,973 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:52,974 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:52,976 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 26, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 00:26:53,188 - pykafka.connection - INFO - Attempt 2: failed to connect to localhost:9092
2025-03-19 00:26:53,189 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 00:26:53,190 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 00:26:53,490 - pykafka.broker - WARNING - Failed to connect to broker at localhost:9092. Check the `listeners` property in server.config.
2025-03-19 00:26:53,491 - pykafka.cluster - ERROR - Socket disconnected during request for broker localhost:9092. Continuing.
2025-03-19 00:26:53,492 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 26, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 03:26:15,774 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-19 03:26:15,925 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 03:26:15,973 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 03:26:15,973 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 03:26:15,974 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 03:26:15,974 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 03:26:15,974 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 03:26:15,976 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 03:26:15,978 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 03:26:15,978 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 03:26:15,979 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 03:26:15,980 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 03:26:15,981 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 03:26:15,984 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 03:26:15,984 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 03:26:15,985 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-19 03:26:15,986 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 03:26:15,987 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 03:26:15,988 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 03:26:15,989 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 03:26:15,991 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 03:26:15,992 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 03:26:15,994 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 03:26:15,995 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 03:26:15,996 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 03:26:15,996 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 03:26:15,997 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 03:26:15,997 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 03:26:15,998 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 03:26:15,999 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 03:26:15,999 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 03:26:15,999 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 03:26:16,000 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-19 03:26:16,001 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-19 03:26:16,002 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-19 03:26:57,866 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 03:26:57,873 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 03:26:57,873 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:26:57,874 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:26:57,878 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:26:57,882 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:26:57,883 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:26:57,883 - pykafka.cluster - DEBUG - Discovered broker id 1: b'localhost':9092
2025-03-19 03:26:57,884 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:26:57,884 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:26:57,885 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:26:57,885 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:26:58,186 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:26:58,186 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:26:58,186 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:26:58,366 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 03:26:58,369 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 03:26:58,369 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:26:58,370 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:26:58,371 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:26:58,374 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:26:58,375 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:26:58,375 - pykafka.cluster - DEBUG - Discovered broker id 1: b'localhost':9092
2025-03-19 03:26:58,376 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:26:58,376 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:26:58,377 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:26:58,377 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:26:58,487 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:26:58,488 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:26:58,488 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:26:58,678 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:26:58,678 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:26:58,679 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:26:58,789 - pykafka.broker - WARNING - Failed to connect to broker at b'localhost':9092. Check the `listeners` property in server.config.
2025-03-19 03:26:58,789 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:26:58,789 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 03:26:58,791 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:26:58,792 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:26:58,795 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:26:58,796 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:26:58,796 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 03:26:58,797 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:26:58,797 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 03:26:58,798 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 03:26:58,798 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:26:58,799 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:26:58,800 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:26:58,802 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:26:58,802 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:26:58,803 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 03:26:58,804 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:26:58,804 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:26:58,805 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:26:58,805 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:26:58,882 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:26:58,980 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:26:58,980 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:26:58,980 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:26:59,106 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:26:59,106 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:26:59,107 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:26:59,279 - pykafka.broker - WARNING - Failed to connect to broker at b'localhost':9092. Check the `listeners` property in server.config.
2025-03-19 03:26:59,280 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:26:59,280 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 03:26:59,281 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:26:59,282 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:26:59,284 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:26:59,285 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:26:59,285 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 03:26:59,286 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:26:59,297 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 03:26:59,297 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 03:26:59,297 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:26:59,298 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:26:59,299 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:26:59,301 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:26:59,302 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:26:59,302 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 03:26:59,303 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:26:59,304 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:26:59,304 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:26:59,304 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:26:59,372 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:26:59,405 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:26:59,406 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:26:59,407 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:26:59,605 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:26:59,606 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:26:59,606 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:26:59,707 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 03:26:59,708 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:26:59,709 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:26:59,709 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:26:59,710 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 03:26:59,793 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:26:59,800 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:26:59,810 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 03:26:59,810 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 03:26:59,811 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 03:26:59,812 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:26:59,813 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:26:59,815 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:26:59,817 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:26:59,818 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:26:59,818 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 03:26:59,819 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:26:59,820 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:26:59,820 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:26:59,821 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:26:59,907 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:26:59,908 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:26:59,908 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:00,121 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:27:00,122 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:00,122 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:00,209 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 03:27:00,209 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:27:00,210 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:27:00,210 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:27:00,211 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 03:27:00,284 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:00,302 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:00,311 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 03:27:00,311 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 03:27:00,312 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 03:27:00,312 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:27:00,313 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:27:00,314 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:27:00,317 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:27:00,317 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:27:00,317 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 03:27:00,318 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:27:00,319 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:27:00,319 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:00,319 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:00,423 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:27:00,424 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:00,425 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:00,620 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:27:00,621 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:00,622 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:00,726 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 03:27:00,726 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:27:00,727 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:27:00,727 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:27:00,728 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 03:27:00,817 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:00,828 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 03:27:00,828 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 03:27:00,829 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 03:27:00,829 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:27:00,830 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:27:00,831 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:27:00,833 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:27:00,833 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:27:00,834 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 03:27:00,835 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:27:00,835 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:27:00,835 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:00,835 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:00,922 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:27:00,923 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:00,923 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:01,136 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:27:01,137 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:01,137 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:01,224 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 03:27:01,225 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:27:01,225 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:27:01,226 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:27:01,226 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 03:27:01,317 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:01,327 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 03:27:01,327 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 03:27:01,328 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 03:27:01,328 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:27:01,329 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:27:01,330 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:27:01,332 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:27:01,333 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:27:01,333 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 03:27:01,334 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:27:01,334 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:27:01,335 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:01,335 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:01,438 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:27:01,439 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:01,439 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:01,636 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:27:01,637 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:01,637 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:01,739 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 03:27:01,740 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:27:01,740 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:27:01,741 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:27:01,741 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 03:27:01,833 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:01,842 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 03:27:01,842 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 03:27:01,843 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 03:27:01,843 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:27:01,844 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:27:01,844 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:27:01,847 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:27:01,847 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:27:01,848 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 03:27:01,848 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:27:01,849 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:27:01,849 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:01,849 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:01,938 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:27:01,939 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:01,939 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:02,150 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:27:02,151 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:02,151 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:02,239 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 03:27:02,240 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:27:02,240 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:27:02,241 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:27:02,241 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 03:27:02,332 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:02,342 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 03:27:02,342 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 03:27:02,343 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 03:27:02,343 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:27:02,344 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:27:02,345 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:27:02,347 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:27:02,347 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:27:02,348 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 03:27:02,348 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:27:02,349 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:27:02,349 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:02,349 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:02,452 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:27:02,453 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:02,453 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:02,650 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:27:02,651 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:02,651 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:02,754 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 03:27:02,754 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:27:02,755 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:27:02,755 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:27:02,756 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 03:27:02,847 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:02,857 - pykafka.producer - ERROR - Message not delivered!! SocketDisconnectedError()
2025-03-19 03:27:02,858 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 03:27:02,870 - connexion.middleware.exceptions - ERROR - SocketDisconnectedError()
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 36, in post_player_performance_event
    producer.produce(msg_str.encode('utf-8'))
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 413, in produce
    raise exc
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 494, in _send_request
    response = owned_broker.broker.produce_messages(req)
  File "/usr/local/lib/python3.13/site-packages/pykafka/broker.py", line 44, in wrapped
    raise SocketDisconnectedError
pykafka.exceptions.SocketDisconnectedError
2025-03-19 03:27:02,887 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 03:27:02,889 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 03:27:02,890 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:27:02,892 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:27:02,893 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:27:02,895 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:27:02,896 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:27:02,896 - pykafka.cluster - DEBUG - Discovered broker id 1: b'localhost':9092
2025-03-19 03:27:02,897 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:27:02,898 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:27:02,898 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:02,899 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:02,952 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:27:02,952 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:02,953 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:03,200 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:27:03,200 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:03,201 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:03,253 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 03:27:03,254 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:27:03,254 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:27:03,255 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:27:03,256 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 03:27:03,347 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:03,357 - pykafka.producer - ERROR - Message not delivered!! SocketDisconnectedError()
2025-03-19 03:27:03,358 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 03:27:03,358 - connexion.middleware.exceptions - ERROR - SocketDisconnectedError()
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 36, in post_player_performance_event
    producer.produce(msg_str.encode('utf-8'))
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 413, in produce
    raise exc
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 494, in _send_request
    response = owned_broker.broker.produce_messages(req)
  File "/usr/local/lib/python3.13/site-packages/pykafka/broker.py", line 44, in wrapped
    raise SocketDisconnectedError
pykafka.exceptions.SocketDisconnectedError
2025-03-19 03:27:03,366 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 03:27:03,367 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 03:27:03,368 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:27:03,368 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:27:03,369 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:27:03,371 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:27:03,372 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:27:03,372 - pykafka.cluster - DEBUG - Discovered broker id 1: b'localhost':9092
2025-03-19 03:27:03,373 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:27:03,373 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:27:03,373 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:03,374 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:03,501 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:27:03,502 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:03,502 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:03,675 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:27:03,675 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:03,676 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:03,803 - pykafka.broker - WARNING - Failed to connect to broker at b'localhost':9092. Check the `listeners` property in server.config.
2025-03-19 03:27:03,803 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:27:03,804 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 03:27:03,805 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:27:03,806 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:27:03,808 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:27:03,809 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:27:03,809 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 03:27:03,810 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:27:03,811 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 03:27:03,811 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 03:27:03,811 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:27:03,812 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:27:03,814 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:27:03,816 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:27:03,816 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:27:03,816 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 03:27:03,817 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:27:03,818 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:27:03,818 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:03,819 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:03,895 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:03,977 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:27:03,978 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:03,978 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:04,119 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:27:04,120 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:04,120 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:04,279 - pykafka.broker - WARNING - Failed to connect to broker at b'localhost':9092. Check the `listeners` property in server.config.
2025-03-19 03:27:04,281 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:27:04,281 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 03:27:04,283 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:27:04,285 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:27:04,289 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:27:04,292 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:27:04,294 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 03:27:04,295 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:27:04,296 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 03:27:04,296 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 03:27:04,297 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:27:04,299 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:27:04,301 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:27:04,304 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:27:04,305 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:27:04,305 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 03:27:04,307 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:27:04,308 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:27:04,308 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:04,308 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:04,372 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:04,421 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:27:04,421 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:04,422 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:04,609 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:27:04,610 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:04,610 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:04,722 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 03:27:04,722 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:27:04,723 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:27:04,723 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:27:04,724 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 03:27:04,809 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:04,816 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:04,825 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 03:27:04,825 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 03:27:04,826 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 03:27:04,826 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:27:04,826 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:27:04,828 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:27:04,830 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:27:04,830 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:27:04,831 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 03:27:04,832 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:27:04,833 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:27:04,833 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:04,834 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:04,911 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:27:04,912 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:04,912 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:05,135 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:27:05,135 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:05,135 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:05,213 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 03:27:05,214 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:27:05,214 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:27:05,214 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:27:05,215 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 03:27:05,289 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:05,304 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:05,315 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 03:27:05,316 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 03:27:05,316 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 03:27:05,317 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:27:05,318 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:27:05,319 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:27:05,322 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:27:05,322 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:27:05,323 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 03:27:05,324 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:27:05,325 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:27:05,325 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:05,325 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:05,436 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:27:05,437 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:05,437 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:05,626 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:27:05,627 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:05,627 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:05,738 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 03:27:05,738 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:27:05,739 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:27:05,739 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:27:05,740 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 03:27:05,830 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:05,840 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 03:27:05,841 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 03:27:05,842 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 03:27:05,843 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:27:05,845 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:27:05,846 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:27:05,848 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:27:05,848 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:27:05,849 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 03:27:05,850 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:27:05,850 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:27:05,851 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:05,851 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:05,928 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:27:05,929 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:05,929 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:06,152 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:27:06,152 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:06,153 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:06,230 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 03:27:06,231 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:27:06,231 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:27:06,231 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:27:06,232 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 03:27:06,322 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:06,332 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 03:27:06,333 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 03:27:06,333 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 03:27:06,334 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:27:06,334 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:27:06,335 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:27:06,337 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:27:06,337 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:27:06,338 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 03:27:06,338 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:27:06,339 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:27:06,339 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:06,340 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:06,454 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:27:06,454 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:06,454 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:06,640 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:27:06,641 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:06,641 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:06,755 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 03:27:06,756 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:27:06,756 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:27:06,756 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:27:06,757 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 03:27:06,848 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:06,858 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 03:27:06,858 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 03:27:06,859 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 03:27:06,859 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:27:06,859 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:27:06,860 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:27:06,862 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:27:06,862 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:27:06,863 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 03:27:06,864 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:27:06,864 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:27:06,864 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:06,865 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:06,942 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:27:06,942 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:06,943 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:07,165 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:27:07,166 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:07,167 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:07,243 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 03:27:07,244 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:27:07,245 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:27:07,245 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:27:07,246 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 03:27:07,337 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:07,346 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 03:27:07,347 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 03:27:07,347 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 03:27:07,348 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 03:27:07,348 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 03:27:07,349 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 03:27:07,351 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 03:27:07,352 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 03:27:07,352 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 03:27:07,352 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 03:27:07,353 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 03:27:07,353 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:07,354 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:07,468 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 03:27:07,469 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:07,469 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:07,654 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 03:27:07,655 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 03:27:07,655 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 03:27:07,770 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 03:27:07,771 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 03:27:07,771 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 03:27:07,772 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 03:27:07,772 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 03:27:07,862 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 03:27:07,873 - pykafka.producer - ERROR - Message not delivered!! SocketDisconnectedError()
2025-03-19 03:27:07,874 - connexion.middleware.exceptions - ERROR - SocketDisconnectedError()
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 54, in post_audience_interaction_event
    producer.produce(msg_str.encode('utf-8'))
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 413, in produce
    raise exc
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 494, in _send_request
    response = owned_broker.broker.produce_messages(req)
  File "/usr/local/lib/python3.13/site-packages/pykafka/broker.py", line 44, in wrapped
    raise SocketDisconnectedError
pykafka.exceptions.SocketDisconnectedError
2025-03-19 03:27:07,875 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 03:27:07,884 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 03:27:07,887 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7efcc87ee850>
2025-03-19 03:27:07,887 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 19:51:05,846 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-19 19:51:05,889 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 19:51:05,933 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 19:51:05,934 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 19:51:05,934 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 19:51:05,935 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 19:51:05,935 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 19:51:05,936 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 19:51:05,937 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 19:51:05,937 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 19:51:05,937 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 19:51:05,938 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 19:51:05,938 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 19:51:05,938 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 19:51:05,939 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 19:51:05,939 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-19 19:51:05,940 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 19:51:05,940 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 19:51:05,940 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 19:51:05,941 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 19:51:05,941 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 19:51:05,942 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 19:51:05,942 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 19:51:05,942 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 19:51:05,943 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 19:51:05,944 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 19:51:05,944 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 19:51:05,944 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 19:51:05,945 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 19:51:05,945 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 19:51:05,946 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 19:51:05,946 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 19:51:05,946 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-19 19:51:05,947 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-19 19:51:05,947 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-19 19:58:20,830 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 19:58:20,843 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 19:58:20,843 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 19:58:20,844 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 19:58:21,192 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 19:58:21,194 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 19:58:21,194 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 19:58:21,195 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 19:58:24,836 - pykafka.connection - INFO - Attempt 0: failed to connect to kafka:9092
2025-03-19 19:58:24,837 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:24,837 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:25,146 - pykafka.connection - INFO - Attempt 0: failed to connect to kafka:9092
2025-03-19 19:58:25,146 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:25,147 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:28,256 - pykafka.connection - INFO - Attempt 1: failed to connect to kafka:9092
2025-03-19 19:58:28,257 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:28,258 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:28,545 - pykafka.connection - INFO - Attempt 1: failed to connect to kafka:9092
2025-03-19 19:58:28,545 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:28,545 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:31,708 - pykafka.connection - INFO - Attempt 2: failed to connect to kafka:9092
2025-03-19 19:58:31,708 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:31,709 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:31,958 - pykafka.connection - INFO - Attempt 2: failed to connect to kafka:9092
2025-03-19 19:58:31,959 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:31,959 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:32,009 - pykafka.broker - WARNING - Failed to connect to broker at kafka:9092. Check the `listeners` property in server.config.
2025-03-19 19:58:32,011 - pykafka.cluster - ERROR - Socket disconnected during request for broker kafka:9092. Continuing.
2025-03-19 19:58:32,012 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 19:58:32,260 - pykafka.broker - WARNING - Failed to connect to broker at kafka:9092. Check the `listeners` property in server.config.
2025-03-19 19:58:32,260 - pykafka.cluster - ERROR - Socket disconnected during request for broker kafka:9092. Continuing.
2025-03-19 19:58:32,262 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 19:58:35,131 - pykafka.connection - INFO - Attempt 0: failed to connect to kafka:9092
2025-03-19 19:58:35,131 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:35,131 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:35,374 - pykafka.connection - INFO - Attempt 0: failed to connect to kafka:9092
2025-03-19 19:58:35,375 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:35,375 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:38,562 - pykafka.connection - INFO - Attempt 1: failed to connect to kafka:9092
2025-03-19 19:58:38,562 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:38,563 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:38,781 - pykafka.connection - INFO - Attempt 1: failed to connect to kafka:9092
2025-03-19 19:58:38,782 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:38,782 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:41,976 - pykafka.connection - INFO - Attempt 2: failed to connect to kafka:9092
2025-03-19 19:58:41,976 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:41,977 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:42,193 - pykafka.connection - INFO - Attempt 2: failed to connect to kafka:9092
2025-03-19 19:58:42,194 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:42,194 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:42,277 - pykafka.broker - WARNING - Failed to connect to broker at kafka:9092. Check the `listeners` property in server.config.
2025-03-19 19:58:42,278 - pykafka.cluster - ERROR - Socket disconnected during request for broker kafka:9092. Continuing.
2025-03-19 19:58:42,278 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 19:58:42,494 - pykafka.broker - WARNING - Failed to connect to broker at kafka:9092. Check the `listeners` property in server.config.
2025-03-19 19:58:42,495 - pykafka.cluster - ERROR - Socket disconnected during request for broker kafka:9092. Continuing.
2025-03-19 19:58:42,495 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 19:58:45,411 - pykafka.connection - INFO - Attempt 0: failed to connect to kafka:9092
2025-03-19 19:58:45,412 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:45,412 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:45,628 - pykafka.connection - INFO - Attempt 0: failed to connect to kafka:9092
2025-03-19 19:58:45,628 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:45,629 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:48,830 - pykafka.connection - INFO - Attempt 1: failed to connect to kafka:9092
2025-03-19 19:58:48,830 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:48,830 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:49,046 - pykafka.connection - INFO - Attempt 1: failed to connect to kafka:9092
2025-03-19 19:58:49,046 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:49,046 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:52,265 - pykafka.connection - INFO - Attempt 2: failed to connect to kafka:9092
2025-03-19 19:58:52,266 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:52,266 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:52,465 - pykafka.connection - INFO - Attempt 2: failed to connect to kafka:9092
2025-03-19 19:58:52,466 - pykafka.connection - INFO - [Errno -2] Name or service not known
2025-03-19 19:58:52,466 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 19:58:52,566 - pykafka.broker - WARNING - Failed to connect to broker at kafka:9092. Check the `listeners` property in server.config.
2025-03-19 19:58:52,567 - pykafka.cluster - ERROR - Socket disconnected during request for broker kafka:9092. Continuing.
2025-03-19 19:58:52,592 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 25, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 19:58:52,766 - pykafka.broker - WARNING - Failed to connect to broker at kafka:9092. Check the `listeners` property in server.config.
2025-03-19 19:58:52,767 - pykafka.cluster - ERROR - Socket disconnected during request for broker kafka:9092. Continuing.
2025-03-19 19:58:52,768 - connexion.middleware.exceptions - ERROR - NoBrokersAvailableError('Unable to connect to a broker to fetch metadata. See logs.')
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 25, in post_player_performance_event
    client = KafkaClient(hosts=f"{app_config['events']['hostname']}:{app_config['events']['port']}")
  File "/usr/local/lib/python3.13/site-packages/pykafka/client.py", line 133, in __init__
    self.cluster = Cluster(
                   ~~~~~~~^
        hosts,
        ^^^^^^
    ...<6 lines>...
        ssl_config=ssl_config,
        ^^^^^^^^^^^^^^^^^^^^^^
        broker_version=broker_version)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 215, in __init__
    self.update()
    ~~~~~~~~~~~^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 510, in update
    metadata = self._get_metadata()
  File "/usr/local/lib/python3.13/site-packages/pykafka/cluster.py", line 304, in _get_metadata
    raise NoBrokersAvailableError(
        'Unable to connect to a broker to fetch metadata. See logs.')
pykafka.exceptions.NoBrokersAvailableError: Unable to connect to a broker to fetch metadata. See logs.
2025-03-19 20:06:25,087 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-19 20:06:25,149 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 20:06:25,237 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:06:25,238 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:06:25,239 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 20:06:25,239 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:06:25,240 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:06:25,243 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:06:25,244 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:06:25,245 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:06:25,245 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:06:25,248 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:06:25,249 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:06:25,249 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:06:25,250 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:06:25,254 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-19 20:06:25,255 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:06:25,256 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:06:25,257 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:06:25,257 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:06:25,258 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:06:25,258 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:06:25,259 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 20:06:25,260 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:06:25,261 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:06:25,261 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 20:06:25,262 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 20:06:25,262 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:06:25,263 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:06:25,264 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 20:06:25,264 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:06:25,265 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:06:25,266 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-19 20:06:25,267 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-19 20:06:25,267 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-19 20:09:24,069 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 20:09:24,081 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:09:24,082 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:24,083 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:24,087 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:24,093 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:24,093 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:24,094 - pykafka.cluster - DEBUG - Discovered broker id 1: b'localhost':9092
2025-03-19 20:09:24,095 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:24,098 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:24,099 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:24,100 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:24,402 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:24,403 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:24,403 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:24,568 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 20:09:24,571 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:09:24,572 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:24,573 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:24,574 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:24,583 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:24,584 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:24,586 - pykafka.cluster - DEBUG - Discovered broker id 1: b'localhost':9092
2025-03-19 20:09:24,587 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:24,588 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:24,588 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:24,589 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:24,704 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:24,705 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:24,705 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:24,890 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:24,891 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:24,891 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:25,006 - pykafka.broker - WARNING - Failed to connect to broker at b'localhost':9092. Check the `listeners` property in server.config.
2025-03-19 20:09:25,006 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:25,007 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:09:25,008 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:25,010 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:25,013 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:25,013 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:25,014 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:09:25,014 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:25,015 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:25,016 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:25,017 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:25,018 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:25,020 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:25,022 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:25,027 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:25,028 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:25,029 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:25,030 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:25,031 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:25,031 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:25,093 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:25,192 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:25,193 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:25,193 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:25,332 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:25,333 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:25,333 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:25,494 - pykafka.broker - WARNING - Failed to connect to broker at b'localhost':9092. Check the `listeners` property in server.config.
2025-03-19 20:09:25,494 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:25,495 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:09:25,496 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:25,497 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:25,499 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:25,500 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:25,501 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:09:25,502 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:25,503 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:25,503 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:25,503 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:25,504 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:25,505 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:25,508 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:25,510 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:25,516 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:25,518 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:25,518 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:25,519 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:25,519 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:25,582 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:25,634 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:25,634 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:25,635 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:25,820 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:25,820 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:25,821 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:25,935 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:25,936 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:25,937 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:25,938 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:25,939 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:26,013 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:26,022 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:26,040 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:26,040 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:26,041 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:26,041 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:26,042 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:26,044 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:26,046 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:26,048 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:26,049 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:26,051 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:26,051 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:26,052 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:26,052 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:26,122 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:26,122 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:26,123 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:26,354 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:26,354 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:26,354 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:26,423 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:26,424 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:26,424 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:26,425 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:26,425 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:26,500 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:26,508 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:26,526 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:26,526 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:26,529 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:26,533 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:26,537 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:26,541 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:26,548 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:26,550 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:26,551 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:26,552 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:26,554 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:26,558 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:26,559 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:26,656 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:26,657 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:26,658 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:26,860 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:26,860 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:26,860 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:26,958 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:26,959 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:26,959 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:26,960 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:26,960 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:27,047 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:27,061 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:27,061 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:27,062 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:27,062 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:27,064 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:27,065 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:27,069 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:27,069 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:27,070 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:27,071 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:27,072 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:27,072 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:27,073 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:27,161 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:27,161 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:27,162 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:27,374 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:27,374 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:27,375 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:27,462 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:27,463 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:27,463 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:27,465 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:27,468 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:27,547 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:27,570 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:27,570 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:27,571 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:27,573 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:27,575 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:27,576 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:27,578 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:27,579 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:27,580 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:27,581 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:27,583 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:27,583 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:27,584 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:27,675 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:27,676 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:27,676 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:27,885 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:27,885 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:27,886 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:27,977 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:27,977 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:27,978 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:27,979 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:27,982 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:28,069 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:28,083 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:28,084 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:28,085 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:28,086 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:28,087 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:28,088 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:28,092 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:28,093 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:28,095 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:28,097 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:28,098 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:28,101 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:28,103 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:28,187 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:28,188 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:28,189 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:28,405 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:28,405 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:28,406 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:28,491 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:28,491 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:28,492 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:28,493 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:28,494 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:28,578 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:28,595 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:28,595 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:28,596 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:28,597 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:28,597 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:28,598 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:28,601 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:28,602 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:28,603 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:28,605 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:28,606 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:28,606 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:28,606 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:28,707 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:28,707 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:28,707 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:28,907 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:28,908 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:28,908 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:29,008 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:29,008 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:29,009 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:29,009 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:29,010 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:29,092 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:29,111 - pykafka.producer - ERROR - Message not delivered!! SocketDisconnectedError()
2025-03-19 20:09:29,130 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:29,132 - connexion.middleware.exceptions - ERROR - SocketDisconnectedError()
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 36, in post_player_performance_event
    producer.produce(msg_str.encode('utf-8'))
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 413, in produce
    raise exc
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 494, in _send_request
    response = owned_broker.broker.produce_messages(req)
  File "/usr/local/lib/python3.13/site-packages/pykafka/broker.py", line 44, in wrapped
    raise SocketDisconnectedError
pykafka.exceptions.SocketDisconnectedError
2025-03-19 20:09:29,172 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 20:09:29,176 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:09:29,177 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:29,179 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:29,180 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:29,186 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:29,187 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:29,189 - pykafka.cluster - DEBUG - Discovered broker id 1: b'localhost':9092
2025-03-19 20:09:29,191 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:29,192 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:29,193 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:29,194 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:29,208 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:29,209 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:29,209 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:29,495 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:29,495 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:29,495 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:29,510 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:29,511 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:29,512 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:29,513 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:29,514 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:29,600 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:29,616 - pykafka.producer - ERROR - Message not delivered!! SocketDisconnectedError()
2025-03-19 20:09:29,618 - connexion.middleware.exceptions - ERROR - SocketDisconnectedError()
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 36, in post_player_performance_event
    producer.produce(msg_str.encode('utf-8'))
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 413, in produce
    raise exc
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 494, in _send_request
    response = owned_broker.broker.produce_messages(req)
  File "/usr/local/lib/python3.13/site-packages/pykafka/broker.py", line 44, in wrapped
    raise SocketDisconnectedError
pykafka.exceptions.SocketDisconnectedError
2025-03-19 20:09:29,619 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:29,629 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 20:09:29,633 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:09:29,634 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:29,635 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:29,636 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:29,640 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:29,641 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:29,642 - pykafka.cluster - DEBUG - Discovered broker id 1: b'localhost':9092
2025-03-19 20:09:29,646 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:29,646 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:29,647 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:29,647 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:29,797 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:29,797 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:29,798 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:29,948 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:29,949 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:29,949 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:30,098 - pykafka.broker - WARNING - Failed to connect to broker at b'localhost':9092. Check the `listeners` property in server.config.
2025-03-19 20:09:30,099 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:30,099 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:09:30,100 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:30,101 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:30,104 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:30,105 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:30,105 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:09:30,106 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:30,107 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:30,107 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:30,107 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:30,108 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:30,109 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:30,111 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:30,112 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:30,114 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:30,116 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:30,117 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:30,118 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:30,118 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:30,186 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:30,250 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:30,250 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:30,251 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:30,419 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:30,421 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:30,421 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:30,551 - pykafka.broker - WARNING - Failed to connect to broker at b'localhost':9092. Check the `listeners` property in server.config.
2025-03-19 20:09:30,552 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:30,552 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:09:30,553 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:30,554 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:30,557 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:30,558 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:30,558 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:09:30,559 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:30,560 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:30,560 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:30,561 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:30,562 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:30,563 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:30,568 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:30,568 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:30,569 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:30,571 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:30,572 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:30,572 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:30,573 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:30,640 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:30,722 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:30,723 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:30,723 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:30,874 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:30,874 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:30,875 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:31,024 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:31,025 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:31,025 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:31,025 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:31,026 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:31,104 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:31,111 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:31,126 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:31,127 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:31,127 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:31,128 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:31,128 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:31,130 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:31,133 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:31,133 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:31,133 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:31,135 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:31,135 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:31,136 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:31,136 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:31,176 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:31,178 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:31,178 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:31,437 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:31,437 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:31,437 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:31,479 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:31,480 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:31,480 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:31,481 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:31,481 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:31,557 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:31,567 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:31,582 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:31,582 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:31,583 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:31,584 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:31,586 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:31,588 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:31,591 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:31,591 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:31,591 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:31,593 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:31,595 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:31,596 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:31,596 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:31,738 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:31,739 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:31,739 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:31,897 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:31,898 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:31,898 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:32,040 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:32,040 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:32,041 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:32,041 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:32,042 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:32,133 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:32,142 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:32,142 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:32,143 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:32,143 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:32,144 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:32,145 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:32,147 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:32,148 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:32,148 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:32,149 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:32,149 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:32,149 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:32,150 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:32,199 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:32,199 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:32,200 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:32,451 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:32,452 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:32,453 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:32,500 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:32,501 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:32,502 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:32,502 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:32,503 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:32,591 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:32,603 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:32,604 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:32,604 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:32,605 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:32,605 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:32,607 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:32,611 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:32,611 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:32,612 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:32,613 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:32,613 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:32,615 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:32,615 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:32,756 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:32,757 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:32,758 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:32,916 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:32,916 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:32,917 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:33,059 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:33,060 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:33,060 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:33,060 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:33,061 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:33,147 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:33,162 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:33,162 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:33,162 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:33,163 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:33,163 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:33,164 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:33,166 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:33,167 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:33,167 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:33,168 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:33,168 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:33,169 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:33,169 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:33,218 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:33,218 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:33,219 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:33,470 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:33,470 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:33,471 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:33,519 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:33,520 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:33,520 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:33,521 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:33,521 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:33,611 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:33,622 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:33,622 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:33,624 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:33,624 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:33,625 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:33,626 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:33,630 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:33,631 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:33,631 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:33,632 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:33,632 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:33,632 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:33,633 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:33,772 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:33,772 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:33,772 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:33,933 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:33,934 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:33,934 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:34,073 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:34,074 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:34,074 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:34,075 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:34,077 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:34,167 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:34,178 - pykafka.producer - ERROR - Message not delivered!! SocketDisconnectedError()
2025-03-19 20:09:34,180 - connexion.middleware.exceptions - ERROR - SocketDisconnectedError()
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 54, in post_audience_interaction_event
    producer.produce(msg_str.encode('utf-8'))
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 413, in produce
    raise exc
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 494, in _send_request
    response = owned_broker.broker.produce_messages(req)
  File "/usr/local/lib/python3.13/site-packages/pykafka/broker.py", line 44, in wrapped
    raise SocketDisconnectedError
pykafka.exceptions.SocketDisconnectedError
2025-03-19 20:09:34,181 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:34,188 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 20:09:34,191 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:09:34,192 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f80d008a850>
2025-03-19 20:09:34,193 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:09:34,235 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:34,235 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:34,236 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:34,536 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:34,537 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:34,537 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:34,537 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:34,538 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:34,630 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:34,639 - pykafka.producer - ERROR - Message not delivered!! SocketDisconnectedError()
2025-03-19 20:09:34,640 - connexion.middleware.exceptions - ERROR - SocketDisconnectedError()
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 54, in post_audience_interaction_event
    producer.produce(msg_str.encode('utf-8'))
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 413, in produce
    raise exc
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 494, in _send_request
    response = owned_broker.broker.produce_messages(req)
  File "/usr/local/lib/python3.13/site-packages/pykafka/broker.py", line 44, in wrapped
    raise SocketDisconnectedError
pykafka.exceptions.SocketDisconnectedError
2025-03-19 20:09:34,646 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:34,654 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 20:09:34,657 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:09:34,658 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:34,664 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:34,668 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:34,672 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:34,672 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:34,673 - pykafka.cluster - DEBUG - Discovered broker id 1: b'localhost':9092
2025-03-19 20:09:34,728 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:34,729 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:34,729 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:34,729 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:35,030 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:35,030 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:35,031 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:35,332 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:35,332 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:35,333 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:35,633 - pykafka.broker - WARNING - Failed to connect to broker at b'localhost':9092. Check the `listeners` property in server.config.
2025-03-19 20:09:35,634 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:35,634 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:09:35,636 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:35,638 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:35,642 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:35,643 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:35,644 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:09:35,646 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:35,648 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:35,650 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:35,654 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:35,655 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:35,661 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:35,670 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:35,670 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:35,671 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:35,674 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:35,675 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:35,677 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:35,678 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:35,679 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:35,980 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:35,980 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:35,980 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:36,281 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:36,282 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:36,283 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:36,583 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:36,584 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:36,584 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:36,585 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:36,585 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:36,643 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:36,670 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:36,686 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:36,686 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:36,692 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:36,693 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:36,695 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:36,697 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:36,700 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:36,700 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:36,701 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:36,702 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:36,703 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:36,704 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:36,705 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:37,006 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:37,006 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:37,007 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:37,308 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:37,309 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:37,309 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:37,610 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:37,611 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:37,611 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:37,612 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:37,612 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:37,700 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:37,713 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:37,713 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:37,715 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:37,716 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:37,717 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:37,718 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:37,723 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:37,725 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:37,726 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:37,727 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:37,727 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:37,728 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:37,728 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:38,030 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:38,030 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:38,030 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:38,332 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:38,333 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:38,333 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:38,633 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:38,634 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:38,634 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:38,635 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:38,635 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:38,723 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:38,736 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:38,736 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:38,737 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:38,738 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:38,739 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:38,741 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:38,752 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:38,752 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:38,753 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:38,754 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:38,754 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:38,755 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:38,755 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:39,056 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:39,060 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:39,062 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:39,077 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:39,080 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:09:39,083 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:39,084 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:39,085 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:39,088 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:39,088 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:39,089 - pykafka.cluster - DEBUG - Discovered broker id 1: b'localhost':9092
2025-03-19 20:09:39,089 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:39,092 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:39,092 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:39,093 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:39,364 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:39,364 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:39,364 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:39,393 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:39,395 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:39,395 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:39,665 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:39,666 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:39,666 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:39,666 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:39,667 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:39,696 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:39,697 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:39,697 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:39,752 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:39,768 - pykafka.producer - ERROR - Message not delivered!! SocketDisconnectedError()
2025-03-19 20:09:39,769 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:39,769 - connexion.middleware.exceptions - ERROR - SocketDisconnectedError()
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 36, in post_player_performance_event
    producer.produce(msg_str.encode('utf-8'))
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 413, in produce
    raise exc
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 494, in _send_request
    response = owned_broker.broker.produce_messages(req)
  File "/usr/local/lib/python3.13/site-packages/pykafka/broker.py", line 44, in wrapped
    raise SocketDisconnectedError
pykafka.exceptions.SocketDisconnectedError
2025-03-19 20:09:39,779 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 20:09:39,783 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:09:39,783 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:39,785 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:39,786 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:39,789 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:39,789 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:39,790 - pykafka.cluster - DEBUG - Discovered broker id 1: b'localhost':9092
2025-03-19 20:09:39,804 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:39,805 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:39,805 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:39,805 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:39,998 - pykafka.broker - WARNING - Failed to connect to broker at b'localhost':9092. Check the `listeners` property in server.config.
2025-03-19 20:09:39,998 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:39,999 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:09:39,999 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:40,001 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:40,003 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:40,003 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:40,004 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:09:40,005 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:40,006 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:40,006 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:40,006 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:40,007 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:40,008 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:40,009 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:40,010 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:40,010 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:40,011 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:40,012 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:40,012 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:40,013 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:40,088 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:40,106 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:40,107 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:40,107 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:40,313 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:40,314 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:40,314 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:40,408 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:40,409 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:40,409 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:40,615 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:40,615 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:40,616 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:40,710 - pykafka.broker - WARNING - Failed to connect to broker at b'localhost':9092. Check the `listeners` property in server.config.
2025-03-19 20:09:40,710 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:40,711 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:09:40,713 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:40,715 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:40,718 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:40,718 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:40,718 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:09:40,719 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:40,720 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:40,721 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:40,721 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:40,722 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:40,723 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:40,725 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:40,726 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:40,726 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:40,727 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:40,728 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:40,728 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:40,729 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:40,789 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:40,916 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:40,917 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:40,918 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:40,919 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:40,920 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:41,003 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:41,010 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:41,020 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:41,021 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:41,021 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:41,022 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:41,022 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:41,023 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:41,026 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:41,027 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:41,027 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:41,029 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:41,030 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:41,030 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:41,031 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:41,031 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:41,032 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:41,032 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:41,332 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:41,333 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:41,333 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:41,334 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:41,334 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:41,335 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:41,635 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:41,635 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:41,635 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:41,636 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:41,636 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:41,637 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:41,637 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:41,638 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:41,718 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:41,725 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:41,739 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:41,739 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:41,739 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:41,741 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:41,741 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:41,742 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:41,745 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:41,745 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:41,746 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:41,747 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:41,747 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:41,748 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:41,749 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:41,937 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:41,938 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:41,938 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:41,939 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:41,939 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:42,027 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:42,040 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:42,040 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:42,041 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:42,041 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:42,042 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:42,043 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:42,046 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:42,047 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:42,047 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:42,050 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:42,052 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:42,052 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:42,052 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:42,053 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:42,053 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:42,054 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:42,355 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:42,355 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:42,355 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:42,356 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:42,356 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:42,357 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:42,658 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:42,658 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:42,659 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:42,659 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:42,659 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:42,660 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:42,660 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:42,662 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:42,745 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:42,764 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:42,764 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:42,765 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:42,765 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:42,767 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:42,769 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:42,772 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:42,773 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:42,773 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:42,774 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:42,774 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:42,775 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:42,775 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:42,963 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:42,964 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:42,964 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:42,965 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:42,965 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:43,046 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:43,066 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:43,067 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:43,068 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:43,068 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:43,069 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:43,070 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:43,073 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:43,073 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:43,073 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:43,086 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:43,086 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:43,087 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:43,087 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:43,087 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:43,088 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:43,089 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:43,389 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:43,390 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:43,390 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:43,391 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:43,391 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:43,391 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:43,692 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:43,692 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:43,693 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:43,693 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:43,694 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:43,694 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:43,695 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:43,696 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:43,772 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:43,796 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:43,797 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:43,799 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:43,800 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:43,800 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:43,802 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:43,808 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:43,809 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:43,810 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:43,811 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:43,812 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:43,813 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:43,813 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:43,995 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:43,996 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:43,996 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:43,997 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:43,998 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:44,073 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:44,099 - pykafka.producer - ERROR - Message not delivered!! SocketDisconnectedError()
2025-03-19 20:09:44,100 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:44,100 - connexion.middleware.exceptions - ERROR - SocketDisconnectedError()
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 36, in post_player_performance_event
    producer.produce(msg_str.encode('utf-8'))
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 413, in produce
    raise exc
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 494, in _send_request
    response = owned_broker.broker.produce_messages(req)
  File "/usr/local/lib/python3.13/site-packages/pykafka/broker.py", line 44, in wrapped
    raise SocketDisconnectedError
pykafka.exceptions.SocketDisconnectedError
2025-03-19 20:09:44,114 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:44,118 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:44,119 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 20:09:44,119 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:44,129 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:09:44,134 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:44,139 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:44,143 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:44,147 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:44,151 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:44,153 - pykafka.cluster - DEBUG - Discovered broker id 1: b'localhost':9092
2025-03-19 20:09:44,157 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:44,159 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:44,160 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:44,161 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:44,433 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:44,433 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:44,433 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:44,462 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:44,462 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:44,463 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:44,734 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:44,734 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:44,735 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:44,735 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:44,736 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:44,763 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:44,764 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:44,765 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:44,809 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:44,837 - pykafka.producer - ERROR - Message not delivered!! SocketDisconnectedError()
2025-03-19 20:09:44,838 - connexion.middleware.exceptions - ERROR - SocketDisconnectedError()
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 54, in post_audience_interaction_event
    producer.produce(msg_str.encode('utf-8'))
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 413, in produce
    raise exc
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 494, in _send_request
    response = owned_broker.broker.produce_messages(req)
  File "/usr/local/lib/python3.13/site-packages/pykafka/broker.py", line 44, in wrapped
    raise SocketDisconnectedError
pykafka.exceptions.SocketDisconnectedError
2025-03-19 20:09:44,839 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:45,066 - pykafka.broker - WARNING - Failed to connect to broker at b'localhost':9092. Check the `listeners` property in server.config.
2025-03-19 20:09:45,066 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:45,067 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:09:45,068 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:45,069 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:45,072 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:45,073 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:45,073 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:09:45,073 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:45,075 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:45,076 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:45,076 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:45,077 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:45,078 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:45,082 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:45,083 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:45,083 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:45,084 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:45,085 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:45,085 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:45,086 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:45,148 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:45,387 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:45,387 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:45,388 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:45,689 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:45,689 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:45,689 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:45,990 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:45,991 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:45,992 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:45,993 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:45,994 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:46,072 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:46,082 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:46,095 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:46,095 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:46,096 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:46,097 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:46,098 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:46,099 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:46,104 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:46,104 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:46,105 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:46,146 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:46,148 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:46,148 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:46,150 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:46,451 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:46,451 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:46,452 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:46,753 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:46,754 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:46,754 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:47,055 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:47,056 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:47,056 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:47,057 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:47,057 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:47,104 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:47,158 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:47,158 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:47,159 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:47,159 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:47,160 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:47,161 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:47,163 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:47,163 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:47,164 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:47,164 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:47,165 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:47,165 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:47,166 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:47,467 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:47,467 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:47,468 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:47,768 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:47,769 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:47,769 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:48,070 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:48,071 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:48,071 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:48,071 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:48,072 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:48,163 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:48,172 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:48,173 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:09:48,174 - pykafka.producer - WARNING - Error encountered when producing to broker b'localhost':9092. Retrying.
2025-03-19 20:09:48,175 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:09:48,175 - pykafka.connection - DEBUG - Connecting to kafka:9092
2025-03-19 20:09:48,177 - pykafka.connection - DEBUG - Successfully connected to kafka:9092
2025-03-19 20:09:48,179 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:09:48,181 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:09:48,182 - pykafka.cluster - INFO - Reconnecting to broker id 1: b'localhost':9092
2025-03-19 20:09:48,182 - pykafka.connection - DEBUG - Connecting to b'localhost':9092
2025-03-19 20:09:48,183 - pykafka.connection - INFO - Attempt 0: failed to connect to b'localhost':9092
2025-03-19 20:09:48,183 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:48,184 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:48,485 - pykafka.connection - INFO - Attempt 1: failed to connect to b'localhost':9092
2025-03-19 20:09:48,485 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:48,486 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:48,787 - pykafka.connection - INFO - Attempt 2: failed to connect to b'localhost':9092
2025-03-19 20:09:48,788 - pykafka.connection - INFO - [Errno 111] Connection refused
2025-03-19 20:09:48,789 - pykafka.connection - INFO - Retrying in 300ms.
2025-03-19 20:09:49,090 - pykafka.cluster - INFO - Failed to re-establish connection with broker id 1: b'localhost':9092
2025-03-19 20:09:49,090 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:09:49,091 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:09:49,091 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:09:49,092 - pykafka.producer - DEBUG - Successfully sent 0/1 messages to broker 1
2025-03-19 20:09:49,179 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:09:49,192 - pykafka.producer - ERROR - Message not delivered!! SocketDisconnectedError()
2025-03-19 20:09:49,193 - pykafka.producer - INFO - Worker exited for broker b'localhost':9092
2025-03-19 20:09:49,194 - connexion.middleware.exceptions - ERROR - SocketDisconnectedError()
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 223, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 764, in app
    await self.default(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/swagger_ui.py", line 236, in default_fn
    await self.app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 158, in __call__
    await self.router(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 460, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/routing.py", line 48, in __call__
    await self.next_app(original_scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/security.py", line 106, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/request_validation.py", line 142, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/response_validation.py", line 127, in __call__
    await self.next_app(scope, receive, wrapped_send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/lifespan.py", line 26, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/abstract.py", line 264, in __call__
    return await operation(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/middleware/context.py", line 25, in __call__
    await self.next_app(scope, receive, send)
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 163, in __call__
    return await self.asgi_app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 165, in __call__
    return await responder(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 200, in __call__
    await self.loop.run_in_executor(
        self.executor, func, environ, self.start_response
    )
  File "/usr/local/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.13/site-packages/a2wsgi/wsgi.py", line 256, in wsgi
    iterable = self.app(environ, start_response)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/apps/flask.py", line 68, in __call__
    return self.fn(*args, **kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 134, in wrapper
    return decorated_function(request)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/response.py", line 172, in wrapper
    handler_response = function(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/parameter.py", line 87, in wrapper
    return function(**kwargs)
  File "/usr/local/lib/python3.13/site-packages/connexion/decorators/main.py", line 123, in wrapper
    return function(*args, **kwargs)
  File "/app/app.py", line 54, in post_audience_interaction_event
    producer.produce(msg_str.encode('utf-8'))
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 413, in produce
    raise exc
  File "/usr/local/lib/python3.13/site-packages/pykafka/producer.py", line 494, in _send_request
    response = owned_broker.broker.produce_messages(req)
  File "/usr/local/lib/python3.13/site-packages/pykafka/broker.py", line 44, in wrapped
    raise SocketDisconnectedError
pykafka.exceptions.SocketDisconnectedError
2025-03-19 20:15:51,040 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f80d0081550>
2025-03-19 20:15:51,050 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:16:47,955 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-19 20:16:48,062 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 20:16:48,167 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:16:48,169 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:16:48,169 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 20:16:48,170 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:16:48,171 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:16:48,173 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:16:48,175 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:16:48,183 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:16:48,188 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:16:48,194 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:16:48,199 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:16:48,200 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:16:48,201 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:16:48,203 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-19 20:16:48,207 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:16:48,208 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:16:48,213 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:16:48,236 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:16:48,275 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:16:48,279 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:16:48,297 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 20:16:48,304 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:16:48,310 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:16:48,311 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 20:16:48,313 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 20:16:48,320 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:16:48,323 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:16:48,324 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 20:16:48,325 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:16:48,325 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:16:48,327 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-19 20:16:48,328 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-19 20:16:48,329 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-19 20:16:54,231 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 20:16:54,235 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:16:54,235 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:16:54,236 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:16:54,247 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:16:54,250 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:16:54,250 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:16:54,251 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:16:54,252 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:16:54,252 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:16:54,253 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:16:54,253 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:16:54,254 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:16:54,255 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:16:54,256 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:16:54,257 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:16:54,257 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:16:54,257 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:16:54,258 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:16:54,300 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:16:54,300 - basicLogger - INFO - Produced player-performance event with trace_id 70a745ad-09ee-4eac-835a-b0b38fe010e7
2025-03-19 20:16:54,301 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fdacee01550>
2025-03-19 20:16:54,301 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:16:54,734 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 20:16:54,736 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:16:54,737 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:16:54,738 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:16:54,739 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:16:54,741 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:16:54,742 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:16:54,742 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:16:54,743 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:16:54,744 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:16:54,744 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:16:54,745 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:16:54,746 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:16:54,747 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:16:54,751 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:16:54,751 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:16:54,751 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:16:54,752 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:16:54,753 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:16:54,768 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:16:54,768 - basicLogger - INFO - Produced player-performance event with trace_id 1f138e43-5184-44f6-a516-20e06fa9ad71
2025-03-19 20:16:54,770 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fdacee107d0>
2025-03-19 20:16:54,770 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:16:55,250 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:16:55,257 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:16:55,741 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:16:55,751 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:16:59,300 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:16:59,301 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:16:59,301 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:16:59,308 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 20:16:59,310 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:16:59,311 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:16:59,313 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:16:59,316 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:16:59,322 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:16:59,323 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:16:59,323 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:16:59,325 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:16:59,326 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:16:59,327 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:16:59,328 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:16:59,330 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:16:59,331 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:16:59,335 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:16:59,335 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:16:59,335 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:16:59,336 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:16:59,337 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:16:59,341 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:16:59,342 - basicLogger - INFO - Produced audience-interaction event with trace_id 34f339ec-2bbd-4a04-b72e-e75d8b2e1781
2025-03-19 20:16:59,342 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fdacee11a90>
2025-03-19 20:16:59,343 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:16:59,768 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:16:59,769 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:16:59,769 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:16:59,773 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 20:16:59,774 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:16:59,774 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:16:59,775 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:16:59,776 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:16:59,778 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:16:59,779 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:16:59,779 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:16:59,780 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:16:59,782 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:16:59,782 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:16:59,783 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:16:59,784 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:16:59,785 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:16:59,789 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:16:59,789 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:16:59,790 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:16:59,790 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:16:59,791 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:16:59,795 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:16:59,795 - basicLogger - INFO - Produced audience-interaction event with trace_id 94abfd5c-3874-4029-a0f7-fb0bd39f5220
2025-03-19 20:16:59,797 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fdacee156e0>
2025-03-19 20:16:59,798 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:17:00,300 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:00,322 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:00,335 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:00,768 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:00,778 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:00,789 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:04,342 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:17:04,343 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:17:04,344 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:17:04,348 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 20:17:04,349 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:17:04,349 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:17:04,350 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:17:04,351 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:17:04,355 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:17:04,355 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:17:04,355 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:17:04,355 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:17:04,356 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:17:04,357 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:17:04,357 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:17:04,358 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:17:04,359 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:17:04,361 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:17:04,361 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:17:04,361 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:17:04,362 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:17:04,362 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:17:04,365 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:17:04,365 - basicLogger - INFO - Produced player-performance event with trace_id 5b04223e-0a6b-4609-92e1-e721af26e8b7
2025-03-19 20:17:04,366 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fdacee16fd0>
2025-03-19 20:17:04,366 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:17:04,797 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:17:04,798 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:17:04,799 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:17:04,802 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 20:17:04,804 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:17:04,804 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:17:04,804 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:17:04,805 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:17:04,808 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:17:04,808 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:17:04,808 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:17:04,808 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:17:04,809 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:17:04,809 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:17:04,810 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:17:04,811 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:17:04,811 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:17:04,814 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:17:04,814 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:17:04,814 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:17:04,815 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:17:04,815 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:17:04,818 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:17:04,818 - basicLogger - INFO - Produced player-performance event with trace_id 3092c8fa-d3ea-4e60-8f53-06441e5734f8
2025-03-19 20:17:04,818 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fdacedfe690>
2025-03-19 20:17:04,819 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:17:05,343 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:05,355 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:05,361 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:05,797 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:05,808 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:05,814 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:09,366 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:17:09,367 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:17:09,368 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:17:09,375 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 20:17:09,380 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:17:09,380 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:17:09,380 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:17:09,381 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:17:09,384 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:17:09,385 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:17:09,386 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:17:09,386 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:17:09,387 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:17:09,388 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:17:09,388 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:17:09,388 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:17:09,389 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:17:09,391 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:17:09,392 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:17:09,392 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:17:09,392 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:17:09,393 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:17:09,397 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:17:09,397 - basicLogger - INFO - Produced audience-interaction event with trace_id 46d9c87c-81c6-462d-9d79-7ab99008a81c
2025-03-19 20:17:09,397 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fdacedfc830>
2025-03-19 20:17:09,398 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:17:09,819 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:17:09,819 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:17:09,820 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:17:09,824 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 20:17:09,825 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:17:09,826 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:17:09,826 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:17:09,827 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:17:09,830 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:17:09,830 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:17:09,830 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:17:09,831 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:17:09,832 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:17:09,832 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:17:09,833 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:17:09,834 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:17:09,835 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:17:09,839 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:17:09,839 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:17:09,839 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:17:09,840 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:17:09,841 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:17:09,843 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:17:09,844 - basicLogger - INFO - Produced audience-interaction event with trace_id 2a4346a8-eab2-4884-9f8f-4d9b5adf9956
2025-03-19 20:17:09,844 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fdacedfd010>
2025-03-19 20:17:09,844 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:17:10,367 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:10,385 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:10,391 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:10,819 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:10,830 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:10,839 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:14,397 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:17:14,398 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:17:14,399 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:17:14,844 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:17:14,845 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:17:14,845 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:17:15,398 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:17:15,844 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:20:44,033 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 20:20:44,037 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:20:44,037 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:20:44,038 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:20:44,039 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:20:44,044 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:44,045 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:20:44,045 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:20:44,046 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:20:44,047 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:20:44,048 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:20:44,048 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:20:44,049 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:20:44,050 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:20:44,052 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:44,052 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:20:44,053 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:20:44,053 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:20:44,054 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:20:44,058 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:20:44,058 - basicLogger - INFO - Produced player-performance event with trace_id b90e3653-c067-4c7f-8d22-4fe98d524075
2025-03-19 20:20:44,059 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fdacedfccb0>
2025-03-19 20:20:44,060 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:20:44,535 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 20:20:44,538 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:20:44,538 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:20:44,539 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:20:44,540 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:20:44,543 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:44,543 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:20:44,544 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:20:44,545 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:20:44,547 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:20:44,548 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:20:44,548 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:20:44,550 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:20:44,551 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:20:44,555 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:44,555 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:20:44,556 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:20:44,556 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:20:44,559 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:20:44,562 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:20:44,563 - basicLogger - INFO - Produced player-performance event with trace_id 2d019100-1a33-4937-99ec-ee95ea29700f
2025-03-19 20:20:44,563 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fdacedfc710>
2025-03-19 20:20:44,563 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:20:45,045 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:20:45,052 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:20:45,543 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:20:45,555 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:20:49,059 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:20:49,060 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:20:49,061 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:49,064 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 20:20:49,065 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:20:49,066 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:20:49,066 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:20:49,067 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:20:49,069 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:49,069 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:20:49,069 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:20:49,070 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:20:49,070 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:20:49,071 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:20:49,071 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:20:49,073 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:20:49,074 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:20:49,076 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:49,076 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:20:49,077 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:20:49,077 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:20:49,078 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:20:49,080 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:20:49,080 - basicLogger - INFO - Produced audience-interaction event with trace_id 61e2ad73-ecf7-4f9a-a540-8cb9476834f6
2025-03-19 20:20:49,080 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fdacedfccb0>
2025-03-19 20:20:49,080 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:20:49,563 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:20:49,564 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:20:49,564 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:49,567 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 20:20:49,569 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:20:49,569 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:20:49,569 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:20:49,570 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:20:49,572 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:49,572 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:20:49,573 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:20:49,573 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:20:49,574 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:20:49,574 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:20:49,574 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:20:49,575 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:20:49,576 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:20:49,578 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:49,578 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:20:49,578 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:20:49,579 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:20:49,579 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:20:49,581 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:20:49,581 - basicLogger - INFO - Produced audience-interaction event with trace_id c49f25d0-9887-4ecb-92f6-cc2a15cb1990
2025-03-19 20:20:49,582 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fdacedfc830>
2025-03-19 20:20:49,582 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:20:50,060 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:20:50,069 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:20:50,076 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:20:50,563 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:20:50,572 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:20:50,578 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:20:54,080 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:20:54,081 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:20:54,081 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:54,084 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 20:20:54,086 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:20:54,086 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:20:54,086 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:20:54,088 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:20:54,089 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:54,090 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:20:54,090 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:20:54,090 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:20:54,091 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:20:54,092 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:20:54,092 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:20:54,092 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:20:54,093 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:20:54,096 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:54,097 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:20:54,097 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:20:54,097 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:20:54,098 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:20:54,100 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:20:54,100 - basicLogger - INFO - Produced player-performance event with trace_id beceb4f9-316f-4b09-a89f-99b702ffe82b
2025-03-19 20:20:54,101 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fdacedfccb0>
2025-03-19 20:20:54,101 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:20:54,582 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:20:54,582 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:20:54,583 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:54,586 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 20:20:54,587 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:20:54,587 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:20:54,588 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:20:54,588 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:20:54,590 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:54,591 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:20:54,591 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:20:54,591 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:20:54,592 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:20:54,593 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:20:54,594 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:20:54,594 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:20:54,595 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:20:54,596 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:54,597 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:20:54,597 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:20:54,597 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:20:54,598 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:20:54,617 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:20:54,617 - basicLogger - INFO - Produced player-performance event with trace_id 1132c522-8a65-4b5f-9b6e-baf5f399f87c
2025-03-19 20:20:54,618 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fdacedfc710>
2025-03-19 20:20:54,618 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:20:55,081 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:20:55,089 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:20:55,096 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:20:55,582 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:20:55,590 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:20:55,596 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:20:59,101 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:20:59,101 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:20:59,102 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:59,105 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 20:20:59,107 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:20:59,107 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:20:59,107 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:20:59,108 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:20:59,110 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:59,111 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:20:59,111 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:20:59,111 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:20:59,112 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:20:59,112 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:20:59,113 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:20:59,113 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:20:59,114 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:20:59,116 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:59,116 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:20:59,116 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:20:59,117 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:20:59,118 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:20:59,120 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:20:59,120 - basicLogger - INFO - Produced audience-interaction event with trace_id 0b6cb98e-951a-41d6-b9bf-01eb95d600bc
2025-03-19 20:20:59,121 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fdacedfccb0>
2025-03-19 20:20:59,121 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:20:59,617 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:20:59,617 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:20:59,618 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:59,622 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 20:20:59,624 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:20:59,624 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:20:59,624 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:20:59,625 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:20:59,628 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:59,628 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:20:59,628 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:20:59,635 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:20:59,637 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:20:59,638 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:20:59,638 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:20:59,639 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:20:59,640 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:20:59,642 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:20:59,643 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:20:59,643 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:20:59,643 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:20:59,644 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:20:59,649 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:20:59,649 - basicLogger - INFO - Produced audience-interaction event with trace_id 754e4b25-c126-409e-831a-5459981c6c94
2025-03-19 20:20:59,650 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fdacedfc830>
2025-03-19 20:20:59,650 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:21:00,101 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:21:00,110 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:21:00,115 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:21:00,617 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:21:00,628 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:21:00,642 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:21:04,120 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:21:04,121 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:21:04,121 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:21:04,650 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:21:04,651 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:21:04,651 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:21:05,120 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:21:05,651 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:32,766 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-19 20:24:32,860 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 20:24:33,027 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:24:33,032 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:24:33,033 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 20:24:33,034 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:24:33,034 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:24:33,036 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:24:33,042 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:24:33,053 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:24:33,054 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:24:33,054 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:24:33,055 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:24:33,056 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:24:33,056 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:24:33,057 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-19 20:24:33,057 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:24:33,058 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:24:33,058 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:24:33,059 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:24:33,065 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:24:33,067 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:24:33,067 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 20:24:33,069 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:24:33,070 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:24:33,071 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 20:24:33,072 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 20:24:33,078 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:24:33,078 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:24:33,079 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 20:24:33,080 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:24:33,081 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:24:33,082 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-19 20:24:33,083 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-19 20:24:33,088 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-19 20:24:38,230 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 20:24:38,240 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:24:38,241 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:24:38,252 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:24:38,267 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:24:38,273 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:38,274 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:24:38,275 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:24:38,277 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:24:38,280 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:24:38,281 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:24:38,282 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:24:38,302 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:24:38,304 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:24:38,309 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:38,309 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:24:38,310 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:24:38,311 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:24:38,312 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:24:38,406 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:24:38,407 - basicLogger - INFO - Produced player-performance event with trace_id e24d46a9-af32-45ce-a080-6102109cf278
2025-03-19 20:24:38,409 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f4064581550>
2025-03-19 20:24:38,409 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:24:38,743 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 20:24:38,748 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:24:38,752 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:24:38,764 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:24:38,771 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:24:38,791 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:38,796 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:24:38,800 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:24:38,893 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:24:38,900 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:24:38,903 - pykafka.cluster - INFO - Discovered 1 topics
2025-03-19 20:24:38,905 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:24:38,909 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:24:38,911 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:24:38,917 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:38,920 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:24:38,923 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:24:38,927 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:24:38,930 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:24:38,937 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:24:38,937 - basicLogger - INFO - Produced player-performance event with trace_id 9274c250-671d-4568-8013-0482f3a296f3
2025-03-19 20:24:38,938 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f40645887d0>
2025-03-19 20:24:38,939 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:24:39,273 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:39,309 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:39,791 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:39,917 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:43,408 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:24:43,409 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:24:43,409 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:43,416 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 20:24:43,418 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:24:43,419 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:24:43,420 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:24:43,421 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:24:43,426 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:43,427 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:24:43,427 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:24:43,428 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:24:43,429 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:24:43,430 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 20:24:43,430 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:24:43,431 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:24:43,433 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:24:43,435 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:43,435 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:24:43,436 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:24:43,436 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:24:43,437 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:24:43,441 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:24:43,441 - basicLogger - INFO - Produced audience-interaction event with trace_id 33386186-e27b-461e-93e7-0a013503721e
2025-03-19 20:24:43,442 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f4064589a90>
2025-03-19 20:24:43,443 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:24:43,938 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:24:43,939 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:24:43,939 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:43,944 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 20:24:43,946 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:24:43,946 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:24:43,947 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:24:43,948 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:24:43,952 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:43,953 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:24:43,953 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:24:43,954 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:24:43,955 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:24:43,956 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 20:24:43,956 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:24:43,957 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:24:43,958 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:24:43,961 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:43,962 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:24:43,962 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:24:43,963 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:24:43,964 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:24:43,967 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:24:43,967 - basicLogger - INFO - Produced audience-interaction event with trace_id 2de79a07-bfac-40a6-8513-a1c681e516cc
2025-03-19 20:24:43,968 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f406458d6e0>
2025-03-19 20:24:43,968 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:24:44,407 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:44,426 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:44,435 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:44,937 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:44,952 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:44,962 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:48,442 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:24:48,442 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:24:48,443 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:48,446 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 20:24:48,447 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:24:48,447 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:24:48,448 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:24:48,448 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:24:48,451 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:48,451 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:24:48,452 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:24:48,452 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:24:48,452 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:24:48,453 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 20:24:48,453 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:24:48,454 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:24:48,454 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:24:48,456 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:48,456 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:24:48,456 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:24:48,457 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:24:48,457 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:24:48,459 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:24:48,459 - basicLogger - INFO - Produced player-performance event with trace_id 04d08fbb-8d3d-4b31-89d5-2cb3f5d3ee54
2025-03-19 20:24:48,460 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f406458efd0>
2025-03-19 20:24:48,460 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:24:48,968 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:24:48,969 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:24:48,970 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:48,973 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 20:24:48,975 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:24:48,975 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:24:48,975 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:24:48,976 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:24:48,978 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:48,979 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:24:48,979 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:24:48,979 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:24:48,980 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:24:48,980 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 20:24:48,981 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:24:48,981 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:24:48,982 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:24:48,984 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:48,984 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:24:48,984 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:24:48,984 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:24:48,985 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:24:48,987 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:24:48,987 - basicLogger - INFO - Produced player-performance event with trace_id 27036e24-3b82-4fd0-aac8-9bf72d4734ba
2025-03-19 20:24:48,988 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f406457a690>
2025-03-19 20:24:48,988 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:24:49,442 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:49,451 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:49,456 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:49,968 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:49,978 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:49,984 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:53,460 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:24:53,460 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:24:53,461 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:53,465 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 20:24:53,466 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:24:53,466 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:24:53,467 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:24:53,468 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:24:53,471 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:53,471 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:24:53,471 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:24:53,472 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:24:53,474 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:24:53,474 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 20:24:53,474 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:24:53,475 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:24:53,475 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:24:53,477 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:53,477 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:24:53,477 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:24:53,478 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:24:53,478 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:24:53,481 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:24:53,481 - basicLogger - INFO - Produced audience-interaction event with trace_id 9a971787-673a-4b16-979b-9245a6572fc3
2025-03-19 20:24:53,481 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f4064578830>
2025-03-19 20:24:53,482 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:24:53,988 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:24:53,988 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:24:53,989 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:53,992 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 20:24:53,994 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 20:24:53,994 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 20:24:53,994 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:24:53,995 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:24:53,997 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:53,998 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 20:24:53,998 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 20:24:53,998 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 20:24:53,999 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 20:24:54,000 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 20:24:54,000 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 20:24:54,000 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 20:24:54,001 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 20:24:54,002 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:54,002 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 20:24:54,003 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 20:24:54,003 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 20:24:54,003 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 20:24:54,005 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 20:24:54,005 - basicLogger - INFO - Produced audience-interaction event with trace_id c49bfd12-4ef1-4598-91f8-5ae5b82e9ddd
2025-03-19 20:24:54,006 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f4064579010>
2025-03-19 20:24:54,006 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:24:54,460 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:54,470 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:54,477 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:54,988 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:54,997 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:55,002 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:24:58,481 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:24:58,482 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:24:58,482 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:59,006 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 20:24:59,007 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 20:24:59,007 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 20:24:59,504 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:25:00,028 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 20:34:56,184 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-19 20:34:56,417 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 20:34:56,469 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:34:56,471 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:34:56,472 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 20:34:56,473 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:34:56,474 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:34:56,478 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:34:56,479 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:34:56,480 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:34:56,482 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:34:56,484 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:34:56,494 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:34:56,495 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:34:56,496 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:34:56,499 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-19 20:34:56,509 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:34:56,511 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:34:56,512 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:34:56,512 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:34:56,513 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:34:56,514 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:34:56,514 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 20:34:56,515 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:34:56,516 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:34:56,517 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 20:34:56,517 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 20:34:56,518 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:34:56,518 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:34:56,519 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 20:34:56,520 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:34:56,520 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:34:56,521 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-19 20:34:56,522 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-19 20:34:56,522 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-19 20:38:38,324 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-19 20:38:38,454 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 20:38:38,606 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:38:38,608 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:38:38,610 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 20:38:38,618 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:38:38,620 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:38:38,625 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:38:38,642 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:38:38,644 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:38:38,645 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:38:38,646 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:38:38,646 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:38:38,647 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:38:38,648 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:38:38,648 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-19 20:38:38,649 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:38:38,649 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:38:38,658 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:38:38,661 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:38:38,665 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:38:38,673 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:38:38,689 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 20:38:38,705 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:38:38,721 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:38:38,728 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 20:38:38,729 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 20:38:38,730 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:38:38,731 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:38:38,749 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 20:38:38,751 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:38:38,761 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:38:38,763 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-19 20:38:38,765 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-19 20:38:38,776 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-19 20:52:08,838 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-19 20:52:09,012 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 20:52:09,113 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:52:09,114 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:52:09,115 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 20:52:09,116 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:52:09,118 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:52:09,124 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:52:09,125 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:52:09,127 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:52:09,128 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:52:09,128 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:52:09,129 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:52:09,130 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:52:09,131 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:52:09,132 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-19 20:52:09,132 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:52:09,133 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:52:09,133 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:52:09,134 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:52:09,135 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:52:09,135 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:52:09,136 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 20:52:09,137 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:52:09,138 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:52:09,138 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 20:52:09,139 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 20:52:09,140 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:52:09,141 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:52:09,150 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 20:52:09,151 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 20:52:09,152 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 20:52:09,153 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-19 20:52:09,159 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-19 20:52:09,164 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-19 21:00:55,947 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-19 21:00:56,050 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 21:00:56,145 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:00:56,149 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:00:56,150 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 21:00:56,151 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:00:56,152 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:00:56,158 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:00:56,161 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:00:56,163 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:00:56,165 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:00:56,168 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:00:56,169 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:00:56,170 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:00:56,170 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:00:56,171 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-19 21:00:56,172 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:00:56,172 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:00:56,173 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:00:56,174 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:00:56,174 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:00:56,175 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:00:56,176 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 21:00:56,177 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:00:56,177 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:00:56,178 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 21:00:56,178 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 21:00:56,180 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:00:56,181 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:00:56,188 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 21:00:56,189 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:00:56,189 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:00:56,190 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-19 21:00:56,191 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-19 21:00:56,192 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-19 21:09:36,926 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-19 21:09:37,000 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 21:09:37,040 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:09:37,042 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:09:37,042 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 21:09:37,043 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:09:37,043 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:09:37,045 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:09:37,045 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:09:37,046 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:09:37,046 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:09:37,047 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:09:37,047 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:09:37,047 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:09:37,048 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:09:37,048 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-19 21:09:37,049 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:09:37,049 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:09:37,052 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:09:37,059 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:09:37,061 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:09:37,062 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:09:37,063 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 21:09:37,064 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:09:37,064 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:09:37,065 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 21:09:37,065 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 21:09:37,066 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:09:37,066 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:09:37,067 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 21:09:37,067 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:09:37,076 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:09:37,077 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-19 21:09:37,079 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-19 21:09:37,080 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-19 21:10:20,029 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 21:10:20,034 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:10:20,035 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:10:20,036 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:10:20,037 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:10:20,060 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:20,060 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:10:20,060 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:10:20,062 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:10:20,063 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:10:20,064 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:10:20,064 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:10:20,065 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:10:20,066 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:10:20,070 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:20,070 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:10:20,071 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:10:20,071 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:10:20,072 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:10:20,153 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:10:20,153 - basicLogger - INFO - Produced player-performance event with trace_id 70c759d6-fa6c-4536-a3b3-280af3e9d37d
2025-03-19 21:10:20,156 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f457ae5d550>
2025-03-19 21:10:20,157 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:10:20,533 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 21:10:20,536 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:10:20,537 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:10:20,538 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:10:20,539 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:10:20,543 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:20,543 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:10:20,544 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:10:20,544 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:10:20,545 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:10:20,546 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:10:20,546 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:10:20,547 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:10:20,548 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:10:20,551 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:20,551 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:10:20,552 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:10:20,552 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:10:20,553 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:10:20,555 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:10:20,556 - basicLogger - INFO - Produced player-performance event with trace_id ca96296e-89c5-4ef6-94cd-e8a7b40fdc53
2025-03-19 21:10:20,556 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f457ae6c7d0>
2025-03-19 21:10:20,557 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:10:21,059 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:21,070 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:21,543 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:21,551 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:25,154 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:10:25,155 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:10:25,155 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:25,159 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 21:10:25,160 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:10:25,161 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:10:25,162 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:10:25,162 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:10:25,165 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:25,165 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:10:25,166 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:10:25,167 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:10:25,167 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:10:25,168 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:10:25,168 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:10:25,169 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:10:25,169 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:10:25,171 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:25,172 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:10:25,172 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:10:25,172 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:10:25,173 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:10:25,176 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:10:25,176 - basicLogger - INFO - Produced audience-interaction event with trace_id 4811d3ca-7a34-46fa-88f0-f936daa76fb6
2025-03-19 21:10:25,177 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f457ae6da90>
2025-03-19 21:10:25,177 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:10:25,556 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:10:25,557 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:10:25,557 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:25,560 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 21:10:25,562 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:10:25,562 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:10:25,563 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:10:25,564 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:10:25,566 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:25,567 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:10:25,567 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:10:25,568 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:10:25,568 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:10:25,569 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:10:25,569 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:10:25,570 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:10:25,570 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:10:25,572 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:25,573 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:10:25,573 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:10:25,574 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:10:25,574 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:10:25,577 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:10:25,577 - basicLogger - INFO - Produced audience-interaction event with trace_id bfe17aa8-dd5a-47fc-a756-50aa7b69cc54
2025-03-19 21:10:25,578 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f457ae716e0>
2025-03-19 21:10:25,578 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:10:26,154 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:26,165 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:26,171 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:26,556 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:26,566 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:26,573 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:30,174 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:10:30,175 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:10:30,175 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:30,179 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 21:10:30,181 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:10:30,181 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:10:30,182 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:10:30,183 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:10:30,186 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:30,186 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:10:30,186 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:10:30,187 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:10:30,188 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:10:30,188 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:10:30,188 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:10:30,189 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:10:30,190 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:10:30,192 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:30,192 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:10:30,193 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:10:30,193 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:10:30,194 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:10:30,197 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:10:30,197 - basicLogger - INFO - Produced player-performance event with trace_id ae49bc09-2f60-47df-8fa0-da581113c031
2025-03-19 21:10:30,197 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f457ae72fd0>
2025-03-19 21:10:30,198 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:10:30,576 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:10:30,576 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:10:30,577 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:30,580 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 21:10:30,581 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:10:30,582 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:10:30,582 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:10:30,584 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:10:30,587 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:30,587 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:10:30,587 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:10:30,587 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:10:30,588 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:10:30,589 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:10:30,589 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:10:30,589 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:10:30,590 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:10:30,592 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:30,592 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:10:30,592 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:10:30,593 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:10:30,593 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:10:30,595 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:10:30,595 - basicLogger - INFO - Produced player-performance event with trace_id 78c22fdf-c857-4fe3-bb72-64b5c4fa7be5
2025-03-19 21:10:30,596 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f457ae56690>
2025-03-19 21:10:30,596 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:10:31,175 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:31,185 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:31,192 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:31,577 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:31,587 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:31,592 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:35,197 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:10:35,198 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:10:35,198 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:35,201 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 21:10:35,203 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:10:35,203 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:10:35,204 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:10:35,205 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:10:35,208 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:35,208 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:10:35,209 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:10:35,209 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:10:35,210 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:10:35,210 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:10:35,211 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:10:35,212 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:10:35,212 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:10:35,214 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:35,214 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:10:35,215 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:10:35,215 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:10:35,216 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:10:35,218 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:10:35,218 - basicLogger - INFO - Produced audience-interaction event with trace_id 7c67b259-f325-45d2-a15e-ed761e2c8f40
2025-03-19 21:10:35,218 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f457ae54830>
2025-03-19 21:10:35,219 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:10:35,596 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:10:35,597 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:10:35,597 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:35,601 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 21:10:35,602 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:10:35,602 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:10:35,603 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:10:35,604 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:10:35,606 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:35,607 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:10:35,607 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:10:35,607 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:10:35,608 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:10:35,608 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:10:35,609 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:10:35,609 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:10:35,610 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:10:35,611 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:35,612 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:10:35,612 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:10:35,612 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:10:35,613 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:10:35,615 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:10:35,615 - basicLogger - INFO - Produced audience-interaction event with trace_id 734a5756-40d5-4b7a-aee3-d30d965ed7d0
2025-03-19 21:10:35,615 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7f457ae55010>
2025-03-19 21:10:35,616 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:10:36,197 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:36,208 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:36,214 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:36,596 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:36,606 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:36,611 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:40,218 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:10:40,219 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:10:40,219 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:40,616 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:10:40,616 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:10:40,617 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:10:41,219 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:10:41,616 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:12:51,335 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-19 21:12:51,462 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 21:12:51,501 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:12:51,502 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:12:51,502 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 21:12:51,503 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:12:51,504 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:12:51,506 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:12:51,507 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:12:51,507 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:12:51,508 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:12:51,508 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:12:51,509 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:12:51,509 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:12:51,511 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:12:51,512 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-19 21:12:51,512 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:12:51,512 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:12:51,513 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:12:51,513 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:12:51,514 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:12:51,514 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:12:51,514 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 21:12:51,515 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:12:51,515 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:12:51,516 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 21:12:51,516 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 21:12:51,517 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:12:51,517 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:12:51,519 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 21:12:51,526 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 21:12:51,531 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 21:12:51,534 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-19 21:12:51,535 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-19 21:12:51,536 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-19 21:16:34,600 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 21:16:34,605 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:16:34,606 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:16:34,607 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:16:34,608 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:16:34,629 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:34,629 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:16:34,630 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:16:34,631 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:16:34,632 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:16:34,632 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:16:34,632 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:16:34,633 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:16:34,634 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:16:34,638 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:34,639 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:16:34,639 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:16:34,639 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:16:34,640 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:16:34,678 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:16:34,678 - basicLogger - INFO - Produced player-performance event with trace_id 3a20e897-941d-46ef-a406-d56be6c7b6b9
2025-03-19 21:16:34,679 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fe9040e5550>
2025-03-19 21:16:34,679 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:16:35,109 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 21:16:35,112 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:16:35,112 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:16:35,113 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:16:35,114 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:16:35,118 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:35,118 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:16:35,119 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:16:35,119 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:16:35,120 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:16:35,121 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:16:35,122 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:16:35,122 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:16:35,123 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:16:35,125 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:35,125 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:16:35,126 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:16:35,126 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:16:35,127 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:16:35,129 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:16:35,130 - basicLogger - INFO - Produced player-performance event with trace_id 8c1e452b-d05f-465b-918f-96b8d83114bf
2025-03-19 21:16:35,130 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fe9040f47d0>
2025-03-19 21:16:35,130 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:16:35,628 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:35,638 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:36,118 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:36,125 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:39,678 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:16:39,679 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:16:39,680 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:39,683 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 21:16:39,685 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:16:39,685 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:16:39,686 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:16:39,687 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:16:39,689 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:39,689 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:16:39,690 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:16:39,690 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:16:39,691 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:16:39,691 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:16:39,692 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:16:39,692 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:16:39,693 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:16:39,694 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:39,695 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:16:39,695 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:16:39,695 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:16:39,696 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:16:39,698 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:16:39,698 - basicLogger - INFO - Produced audience-interaction event with trace_id 4f5c002b-3bed-4c8b-8b05-560ee29181b7
2025-03-19 21:16:39,698 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fe9040f5a90>
2025-03-19 21:16:39,699 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:16:40,130 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:16:40,139 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:16:40,139 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:40,144 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 21:16:40,147 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:16:40,147 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:16:40,148 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:16:40,150 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:16:40,154 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:40,154 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:16:40,154 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:16:40,155 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:16:40,156 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:16:40,156 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:16:40,156 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:16:40,157 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:16:40,158 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:16:40,160 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:40,160 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:16:40,160 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:16:40,160 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:16:40,161 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:16:40,163 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:16:40,163 - basicLogger - INFO - Produced audience-interaction event with trace_id 1e0bc076-fec2-4347-9bf3-2f31e3f267d7
2025-03-19 21:16:40,163 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fe9040f96e0>
2025-03-19 21:16:40,164 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:16:40,679 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:40,689 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:40,694 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:41,130 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:41,153 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:41,160 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:44,698 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:16:44,699 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:16:44,700 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:44,703 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 21:16:44,704 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:16:44,704 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:16:44,705 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:16:44,706 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:16:44,708 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:44,709 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:16:44,709 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:16:44,709 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:16:44,710 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:16:44,711 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:16:44,711 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:16:44,711 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:16:44,712 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:16:44,714 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:44,715 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:16:44,715 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:16:44,715 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:16:44,716 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:16:44,718 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:16:44,718 - basicLogger - INFO - Produced player-performance event with trace_id eb70bb19-fee6-4de1-a4ba-0ddf9a8eadaf
2025-03-19 21:16:44,719 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fe9040fafd0>
2025-03-19 21:16:44,719 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:16:45,164 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:16:45,164 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:16:45,165 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:45,167 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 21:16:45,169 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:16:45,169 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:16:45,169 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:16:45,170 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:16:45,173 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:45,173 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:16:45,173 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:16:45,173 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:16:45,174 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:16:45,174 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:16:45,175 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:16:45,175 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:16:45,176 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:16:45,178 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:45,178 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:16:45,178 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:16:45,178 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:16:45,179 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:16:45,181 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:16:45,181 - basicLogger - INFO - Produced player-performance event with trace_id 852fb434-c4a5-4f56-af3a-41f690d08070
2025-03-19 21:16:45,182 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fe9040de690>
2025-03-19 21:16:45,182 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:16:45,699 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:45,708 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:45,714 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:46,164 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:46,172 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:46,178 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:49,719 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:16:49,720 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:16:49,720 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:49,724 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 21:16:49,726 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:16:49,726 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:16:49,727 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:16:49,728 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:16:49,731 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:49,732 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:16:49,732 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:16:49,732 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:16:49,733 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:16:49,734 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:16:49,734 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:16:49,735 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:16:49,736 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:16:49,738 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:49,739 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:16:49,739 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:16:49,739 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:16:49,740 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:16:49,742 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:16:49,742 - basicLogger - INFO - Produced audience-interaction event with trace_id 2ffb881e-418f-41a7-90e7-b92c7a3ac799
2025-03-19 21:16:49,743 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fe9040dc830>
2025-03-19 21:16:49,743 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:16:50,182 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:16:50,182 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:16:50,182 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:50,186 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 21:16:50,187 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:16:50,188 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:16:50,188 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:16:50,189 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:16:50,192 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:50,193 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:16:50,193 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:16:50,193 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:16:50,195 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:16:50,196 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:16:50,197 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:16:50,198 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:16:50,199 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:16:50,201 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:50,202 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:16:50,202 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:16:50,203 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:16:50,203 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:16:50,205 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:16:50,205 - basicLogger - INFO - Produced audience-interaction event with trace_id c8041c1f-77cf-4d3b-8b19-9c18dce1d14c
2025-03-19 21:16:50,206 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fe9040dd010>
2025-03-19 21:16:50,206 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:16:50,720 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:50,731 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:50,738 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:51,182 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:51,192 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:51,201 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:54,743 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:16:54,744 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:16:54,744 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:55,206 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:16:55,207 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:16:55,207 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:16:55,744 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:16:56,206 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:43,494 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 21:18:43,497 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:18:43,497 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:18:43,498 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:18:43,499 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:18:43,502 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:43,502 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:18:43,503 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:18:43,503 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:18:43,504 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:18:43,504 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:18:43,505 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:18:43,505 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:18:43,506 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:18:43,508 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:43,508 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:18:43,508 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:18:43,509 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:18:43,509 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:18:43,514 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:18:43,514 - basicLogger - INFO - Produced player-performance event with trace_id 9a8aaffe-bb76-470f-96fe-6da0c1976136
2025-03-19 21:18:43,516 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fe9040dccb0>
2025-03-19 21:18:43,516 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:18:44,005 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 21:18:44,006 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:18:44,007 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:18:44,007 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:18:44,008 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:18:44,011 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:44,011 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:18:44,011 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:18:44,012 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:18:44,013 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:18:44,013 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:18:44,014 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:18:44,014 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:18:44,015 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:18:44,017 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:44,018 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:18:44,018 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:18:44,019 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:18:44,019 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:18:44,021 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:18:44,022 - basicLogger - INFO - Produced player-performance event with trace_id 4a7b4310-be9a-4b6b-b541-ba4b018580b3
2025-03-19 21:18:44,022 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fe9040dc710>
2025-03-19 21:18:44,024 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:18:44,501 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:44,508 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:45,011 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:45,017 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:48,516 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:18:48,516 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:18:48,517 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:48,520 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 21:18:48,522 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:18:48,522 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:18:48,523 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:18:48,523 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:18:48,526 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:48,526 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:18:48,526 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:18:48,527 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:18:48,527 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:18:48,528 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:18:48,528 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:18:48,528 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:18:48,529 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:18:48,531 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:48,531 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:18:48,531 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:18:48,531 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:18:48,532 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:18:48,534 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:18:48,534 - basicLogger - INFO - Produced audience-interaction event with trace_id 7ba407f5-41da-40be-ad1b-0416d10dddd8
2025-03-19 21:18:48,534 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fe9040dccb0>
2025-03-19 21:18:48,534 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:18:49,022 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:18:49,023 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:18:49,023 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:49,027 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 21:18:49,028 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:18:49,029 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:18:49,029 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:18:49,030 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:18:49,032 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:49,032 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:18:49,032 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:18:49,033 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:18:49,033 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:18:49,034 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:18:49,034 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:18:49,035 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:18:49,035 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:18:49,038 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:49,038 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:18:49,038 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:18:49,039 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:18:49,039 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:18:49,042 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:18:49,043 - basicLogger - INFO - Produced audience-interaction event with trace_id f5091df7-0bc5-4ad4-98b9-25b87a00a5a9
2025-03-19 21:18:49,043 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fe9040dc830>
2025-03-19 21:18:49,043 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:18:49,515 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:49,525 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:49,531 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:50,022 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:50,032 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:50,038 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:53,534 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:18:53,535 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:18:53,535 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:53,538 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 21:18:53,540 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:18:53,540 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:18:53,541 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:18:53,541 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:18:53,544 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:53,545 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:18:53,545 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:18:53,546 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:18:53,547 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:18:53,547 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:18:53,547 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:18:53,548 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:18:53,548 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:18:53,550 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:53,550 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:18:53,551 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:18:53,551 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:18:53,551 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:18:53,553 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:18:53,554 - basicLogger - INFO - Produced player-performance event with trace_id 7040f2e9-b4f1-47aa-91cf-0893cb83561f
2025-03-19 21:18:53,554 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fe9040dccb0>
2025-03-19 21:18:53,554 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:18:54,043 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:18:54,043 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:18:54,043 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:54,046 - connexion.validators.parameter - DEBUG - /events/player-performance validating parameters...
2025-03-19 21:18:54,048 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:18:54,048 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:18:54,048 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:18:54,049 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:18:54,051 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:54,052 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:18:54,052 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:18:54,052 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:18:54,053 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:18:54,053 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:18:54,053 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:18:54,054 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:18:54,054 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:18:54,056 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:54,056 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:18:54,056 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:18:54,057 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:18:54,057 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:18:54,061 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:18:54,061 - basicLogger - INFO - Produced player-performance event with trace_id 737c3f63-54ba-4f91-9475-9b5de5c167e9
2025-03-19 21:18:54,062 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fe9040dc710>
2025-03-19 21:18:54,062 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:18:54,535 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:54,544 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:54,550 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:55,043 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:55,051 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:55,056 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:58,554 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:18:58,555 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:18:58,555 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:58,558 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 21:18:58,560 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:18:58,561 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:18:58,561 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:18:58,562 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:18:58,565 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:58,565 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:18:58,566 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:18:58,566 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:18:58,567 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:18:58,568 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:18:58,568 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:18:58,569 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:18:58,569 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:18:58,571 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:58,577 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:18:58,578 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:18:58,578 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:18:58,579 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:18:58,581 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:18:58,581 - basicLogger - INFO - Produced audience-interaction event with trace_id 265d72a9-05f1-4540-80da-221dc0781f7b
2025-03-19 21:18:58,582 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fe9040dccb0>
2025-03-19 21:18:58,582 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:18:59,062 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:18:59,062 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:18:59,062 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:59,066 - connexion.validators.parameter - DEBUG - /events/audience-interaction validating parameters...
2025-03-19 21:18:59,067 - pykafka.cluster - INFO - Broker version is too old to use automatic API version discovery. Falling back to hardcoded versions list.
2025-03-19 21:18:59,068 - pykafka.cluster - DEBUG - Updating cluster, attempt 1/3
2025-03-19 21:18:59,068 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:18:59,069 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:18:59,071 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:59,072 - pykafka.cluster - INFO - Discovered 1 brokers
2025-03-19 21:18:59,072 - pykafka.cluster - DEBUG - Discovered broker id 1: b'kafka':29092
2025-03-19 21:18:59,073 - pykafka.connection - DEBUG - Connecting to b'kafka':29092
2025-03-19 21:18:59,073 - pykafka.connection - DEBUG - Successfully connected to b'kafka':29092
2025-03-19 21:18:59,074 - pykafka.cluster - INFO - Discovered 2 topics
2025-03-19 21:18:59,074 - pykafka.cluster - DEBUG - Discovered topic 'b'events''
2025-03-19 21:18:59,075 - pykafka.connection - DEBUG - Connecting to kafka:29092
2025-03-19 21:18:59,076 - pykafka.connection - DEBUG - Successfully connected to kafka:29092
2025-03-19 21:18:59,078 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:18:59,078 - pykafka.topic - INFO - Adding 1 partitions
2025-03-19 21:18:59,079 - pykafka.topic - DEBUG - Adding partition b'events'/0
2025-03-19 21:18:59,079 - pykafka.producer - INFO - Starting new produce worker for broker 1
2025-03-19 21:18:59,080 - pykafka.producer - DEBUG - Sending 1 messages to broker 1
2025-03-19 21:18:59,082 - pykafka.producer - DEBUG - Successfully sent 1/1 messages to broker 1
2025-03-19 21:18:59,082 - basicLogger - INFO - Produced audience-interaction event with trace_id 64910665-3e84-45d6-80bf-2535307c2b37
2025-03-19 21:18:59,083 - pykafka.producer - DEBUG - Finalising <pykafka.producer.Producer at 0x7fe9040dc830>
2025-03-19 21:18:59,083 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:18:59,553 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:59,563 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:18:59,570 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:19:00,060 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:19:00,070 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:19:00,077 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:19:03,581 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:19:03,581 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:19:03,582 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:19:04,082 - pykafka.producer - INFO - Worker exited for broker b'kafka':29092
2025-03-19 21:19:04,084 - pykafka.producer - INFO - Blocking until all messages are sent or until pending_timeout_ms
2025-03-19 21:19:04,085 - pykafka.handlers - INFO - RequestHandler.stop: about to flush requests queue
2025-03-19 21:19:04,581 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 21:19:05,082 - pykafka.handlers - INFO - RequestHandler worker: exiting cleanly
2025-03-19 23:49:26,761 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-19 23:49:26,861 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 23:49:27,012 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 23:49:27,017 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 23:49:27,021 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 23:49:27,024 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 23:49:27,026 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 23:49:27,033 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 23:49:27,034 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 23:49:27,035 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 23:49:27,035 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 23:49:27,036 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 23:49:27,037 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 23:49:27,037 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 23:49:27,038 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 23:49:27,038 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-19 23:49:27,039 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 23:49:27,041 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 23:49:27,041 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 23:49:27,042 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 23:49:27,043 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 23:49:27,044 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 23:49:27,046 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 23:49:27,047 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 23:49:27,048 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 23:49:27,049 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-19 23:49:27,050 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-19 23:49:27,050 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 23:49:27,051 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 23:49:27,052 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-19 23:49:27,053 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-19 23:49:27,054 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-19 23:49:27,055 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-19 23:49:27,056 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-19 23:49:27,057 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-20 03:11:40,610 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-20 03:11:40,697 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-20 03:11:40,755 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:11:40,756 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:11:40,757 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-20 03:11:40,758 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:11:40,759 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:11:40,762 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:11:40,763 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:11:40,764 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:11:40,765 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:11:40,766 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:11:40,767 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:11:40,768 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:11:40,769 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:11:40,770 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-20 03:11:40,771 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:11:40,772 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:11:40,773 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:11:40,773 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:11:40,774 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:11:40,775 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:11:40,776 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-20 03:11:40,777 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:11:40,777 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:11:40,778 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-20 03:11:40,778 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-20 03:11:40,779 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:11:40,779 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:11:40,780 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-20 03:11:40,781 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:11:40,781 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:11:40,782 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-20 03:11:40,783 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-20 03:11:40,784 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-20 03:33:21,122 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-20 03:33:21,266 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-20 03:33:21,362 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:33:21,363 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:33:21,364 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-20 03:33:21,365 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:33:21,366 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:33:21,370 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:33:21,372 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:33:21,373 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:33:21,374 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:33:21,375 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:33:21,375 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:33:21,376 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:33:21,378 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:33:21,379 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-20 03:33:21,380 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:33:21,380 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:33:21,381 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:33:21,381 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:33:21,382 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:33:21,383 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:33:21,383 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-20 03:33:21,384 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:33:21,387 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:33:21,387 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-20 03:33:21,388 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-20 03:33:21,389 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:33:21,390 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:33:21,391 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-20 03:33:21,392 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:33:21,394 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:33:21,395 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-20 03:33:21,396 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-20 03:33:21,396 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-20 03:37:32,101 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-20 03:37:32,211 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-20 03:37:32,379 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:37:32,383 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:37:32,384 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-20 03:37:32,385 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:37:32,386 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:37:32,389 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:37:32,390 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:37:32,391 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:37:32,394 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:37:32,398 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:37:32,399 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:37:32,402 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:37:32,411 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:37:32,413 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-20 03:37:32,414 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:37:32,419 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:37:32,422 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:37:32,425 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:37:32,427 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:37:32,429 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:37:32,432 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-20 03:37:32,435 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:37:32,441 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:37:32,444 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-20 03:37:32,446 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-20 03:37:32,447 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:37:32,449 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:37:32,450 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-20 03:37:32,451 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:37:32,451 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:37:32,456 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-20 03:37:32,457 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-20 03:37:32,458 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-20 03:43:42,622 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-20 03:43:42,694 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-20 03:43:42,748 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:43:42,749 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:43:42,751 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-20 03:43:42,751 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:43:42,752 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:43:42,755 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:43:42,755 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:43:42,756 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:43:42,757 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:43:42,757 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:43:42,758 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:43:42,760 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:43:42,760 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:43:42,761 - connexion.middleware.validation - DEBUG - Strict Request Validation: True
2025-03-20 03:43:42,762 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:43:42,762 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:43:42,763 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:43:42,764 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:43:42,765 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:43:42,766 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:43:42,767 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-20 03:43:42,768 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:43:42,768 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:43:42,769 - connexion.middleware.security - DEBUG - ... Security: None
2025-03-20 03:43:42,770 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
2025-03-20 03:43:42,770 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:43:42,771 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:43:42,772 - connexion.middleware.abstract - DEBUG - Adding /events/audience-interaction...
2025-03-20 03:43:42,773 - connexion.operations.openapi3 - DEBUG - consumes: ['application/json']
2025-03-20 03:43:42,773 - connexion.operations.openapi3 - DEBUG - produces: []
2025-03-20 03:43:42,775 - connexion.middleware.swagger_ui - INFO - Adding spec json: /openapi.json
2025-03-20 03:43:42,775 - connexion.middleware.swagger_ui - DEBUG - Adding spec yaml: //openapi.yaml
2025-03-20 03:43:42,776 - connexion.middleware.swagger_ui - DEBUG - Adding swagger-ui: /ui/
2025-03-20 03:45:22,538 - connexion.middleware.main - WARNING - `ConnexionMiddleware.run` is optimized for development. For production, run using a dedicated ASGI server.
2025-03-20 03:45:22,615 - connexion.middleware.abstract - DEBUG - Adding /events/player-performance...
